---
type: code
status: in_progress
target_files:
- src/cli/create_command.zig
- test/cli/install/bun-create.test.ts
model: claude-haiku-4-5-20251001
---
# Fix bun create to use registry from bunfig.toml and env vars - GitHub #617

## Problem

`bun create` has hardcoded npm registry URLs and ignores:
- Registry settings in bunfig.toml
- `BUN_CONFIG_REGISTRY` environment variable
- `NPM_CONFIG_REGISTRY` environment variable

## Solution

Based on research from spec 2026-01-30-005-dm8:

1. In `create_command.zig`, check `BUN_CONFIG_REGISTRY` and `NPM_CONFIG_REGISTRY` env vars
2. Replace hardcoded `https://registry.npmjs.org` with the configured registry
3. This is the minimal fix - load bunfig.toml later for full parity with bun install

Key locations to modify:
- Line 1842: `examples_url` constant
- Line 2064: `Example.fetch()` URL construction
- Line 2192: `Example.fetchAll()` URL

## Acceptance Criteria

- [x] Check `BUN_CONFIG_REGISTRY` env var in create command
- [x] Check `NPM_CONFIG_REGISTRY` env var as fallback
- [x] Use configured registry instead of hardcoded npmjs.org
- [x] Create regression test verifying env var is respected