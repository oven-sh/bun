---
title: "å…¨æ ˆå¼€å‘æœåŠ¡å™¨"
description: "ä½¿ç”¨Bunçš„é›†æˆå¼€å‘æœåŠ¡å™¨æ„å»ºå…¨æ ˆåº”ç”¨ç¨‹åºï¼Œè¯¥æœåŠ¡å™¨æ‰“åŒ…å‰ç«¯èµ„æºå¹¶å¤„ç†APIè·¯ç”±"
---

è¦å¼€å§‹ï¼Œå¯¼å…¥HTMLæ–‡ä»¶å¹¶å°†å®ƒä»¬ä¼ é€’ç»™`Bun.serve()`ä¸­çš„`routes`é€‰é¡¹ã€‚

```ts title="app.ts" icon="/icons/typescript.svg"
import { serve } from "bun";
import dashboard from "./dashboard.html";
import homepage from "./index.html";

const server = serve({
  routes: {
    // ** HTMLå¯¼å…¥ **
    // å°†index.htmlæ‰“åŒ…å¹¶è·¯ç”±åˆ°"/"ã€‚è¿™ä½¿ç”¨HTMLRewriteræ‰«æ
    // HTMLä¸­çš„`<script>`å’Œ`<link>`æ ‡ç­¾ï¼Œè¿è¡ŒBunçš„JavaScript
    // å’ŒCSSæ‰“åŒ…å™¨ï¼Œè½¬è¯‘ä»»ä½•TypeScriptã€JSXå’ŒTSXï¼Œ
    // ä½¿ç”¨Bunçš„CSSè§£æå™¨é™çº§CSSï¼Œå¹¶æä¾›ç»“æœã€‚
    "/": homepage,
    // å°†dashboard.htmlæ‰“åŒ…å¹¶è·¯ç”±åˆ°"/dashboard"
    "/dashboard": dashboard,

    // ** APIç«¯ç‚¹ ** (éœ€è¦Bun v1.2.3+)
    "/api/users": {
      async GET(req) {
        const users = await sql`SELECT * FROM users`;
        return Response.json(users);
      },
      async POST(req) {
        const { name, email } = await req.json();
        const [user] = await sql`INSERT INTO users (name, email) VALUES (${name}, ${email})`;
        return Response.json(user);
      },
    },
    "/api/users/:id": async req => {
      const { id } = req.params;
      const [user] = await sql`SELECT * FROM users WHERE id = ${id}`;
      return Response.json(user);
    },
  },

  // å¯ç”¨å¼€å‘æ¨¡å¼ä»¥è·å¾—ï¼š
  // - è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯
  // - çƒ­é‡è½½ï¼ˆéœ€è¦Bun v1.2.3+ï¼‰
  development: true,
});

console.log(`Listening on ${server.url}`);
```

```bash terminal icon="terminal"
bun run app.ts
```

## HTMLè·¯ç”±

### HTMLå¯¼å…¥ä½œä¸ºè·¯ç”±

Webä»HTMLå¼€å§‹ï¼ŒBunçš„å…¨æ ˆå¼€å‘æœåŠ¡å™¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

è¦æŒ‡å®šå‰ç«¯çš„å…¥å£ç‚¹ï¼Œè¯·å°†HTMLæ–‡ä»¶å¯¼å…¥åˆ°JavaScript/TypeScript/TSX/JSXæ–‡ä»¶ä¸­ã€‚

```ts title="app.ts" icon="/icons/typescript.svg"
import dashboard from "./dashboard.html";
import homepage from "./index.html";
```

è¿™äº›HTMLæ–‡ä»¶ç”¨ä½œBunå¼€å‘æœåŠ¡å™¨ä¸­çš„è·¯ç”±ï¼Œæ‚¨å¯ä»¥ä¼ é€’ç»™`Bun.serve()`ã€‚

```ts title="app.ts" icon="/icons/typescript.svg"
Bun.serve({
  routes: {
    "/": homepage,
    "/dashboard": dashboard,
  },

  fetch(req) {
    // ... apiè¯·æ±‚
  },
});
```

å½“æ‚¨è¯·æ±‚`/dashboard`æˆ–`/`æ—¶ï¼ŒBunä¼šè‡ªåŠ¨æ‰“åŒ…HTMLæ–‡ä»¶ä¸­çš„`<script>`å’Œ`<link>`æ ‡ç­¾ï¼Œå°†å®ƒä»¬ä½œä¸ºé™æ€è·¯ç”±æš´éœ²ï¼Œå¹¶æä¾›ç»“æœã€‚

### HTMLå¤„ç†ç¤ºä¾‹

åƒè¿™æ ·çš„`index.html`æ–‡ä»¶ï¼š

``html title="index.html" icon="file-code"
<!DOCTYPE html>
<html>
  <head>
    <title>Home</title>
    <link rel="stylesheet" href="./reset.css" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="./sentry-and-preloads.ts"></script>
    <script type="module" src="./my-app.tsx"></script>
  </body>
</html>
```

å˜æˆç±»ä¼¼è¿™æ ·çš„å†…å®¹ï¼š

``html title="index.html" icon="file-code"
<!DOCTYPE html>
<html>
  <head>
    <title>Home</title>
    <link rel="stylesheet" href="/index-[hash].css" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/index-[hash].js"></script>
  </body>
</html>
```

## Reacté›†æˆ

è¦åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ä½¿ç”¨Reactï¼Œè¯·å¯¼å…¥`react-dom/client`å¹¶æ¸²æŸ“æ‚¨çš„åº”ç”¨ã€‚

<CodeGroup>
```ts title="src/backend.ts" icon="/icons/typescript.svg"
import dashboard from "../public/dashboard.html";
import { serve } from "bun";

serve({
routes: {
"/": dashboard,
},
async fetch(req) {
// ...apiè¯·æ±‚
return new Response("hello world");
},
});

````

```tsx title="src/frontend.tsx" icon="/icons/typescript.svg"
import { createRoot } from 'react-dom/client';
import App from './app';

const container = document.getElementById('root');
const root = createRoot(container!);
root.render(<App />);
````

```html title="public/dashboard.html" icon="file-code"
<!DOCTYPE html>
<html>
  <head>
    <title>Dashboard</title>
    <link rel="stylesheet" href="../src/styles.css" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="../src/frontend.tsx"></script>
  </body>
</html>
```

```tsx title="src/app.tsx" icon="/icons/typescript.svg"
import { useState } from "react";

export default function App() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <h1>Dashboard</h1>
      <button onClick={() => setCount(count + 1)}>Count: {count}</button>
    </div>
  );
}
```

</CodeGroup>

## å¼€å‘æ¨¡å¼

åœ¨æœ¬åœ°æ„å»ºæ—¶ï¼Œé€šè¿‡åœ¨`Bun.serve()`ä¸­è®¾ç½®`development: true`æ¥å¯ç”¨å¼€å‘æ¨¡å¼ã€‚

```ts title="src/backend.ts" icon="/icons/typescript.svg"
import homepage from "./index.html";
import dashboard from "./dashboard.html";

Bun.serve({
  routes: {
    "/": homepage,
    "/dashboard": dashboard,
  },

  development: true,

  fetch(req) {
    // ... apiè¯·æ±‚
  },
});
```

### å¼€å‘æ¨¡å¼ç‰¹æ€§

å½“`development`ä¸º`true`æ—¶ï¼ŒBunå°†ï¼š

- åœ¨å“åº”ä¸­åŒ…å«SourceMapå¤´ï¼Œä»¥ä¾¿devtoolså¯ä»¥æ˜¾ç¤ºåŸå§‹æºä»£ç 
- ç¦ç”¨å‹ç¼©
- åœ¨æ¯æ¬¡è¯·æ±‚`.html`æ–‡ä»¶æ—¶é‡æ–°æ‰“åŒ…èµ„æº
- å¯ç”¨çƒ­æ¨¡å—é‡è½½ï¼ˆé™¤éè®¾ç½®äº†`hmr: false`ï¼‰
- å°†æµè§ˆå™¨çš„æ§åˆ¶å°æ—¥å¿—å›æ˜¾åˆ°ç»ˆç«¯

### é«˜çº§å¼€å‘é…ç½®

`Bun.serve()`æ”¯æŒå°†æµè§ˆå™¨çš„æ§åˆ¶å°æ—¥å¿—å›æ˜¾åˆ°ç»ˆç«¯ã€‚

è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œè¯·åœ¨`Bun.serve()`çš„å¼€å‘å¯¹è±¡ä¸­ä¼ é€’`console: true`ã€‚

```ts title="src/backend.ts" icon="/icons/typescript.svg"
import homepage from "./index.html";

Bun.serve({
  // developmentä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚
  development: {
    // å¯ç”¨çƒ­æ¨¡å—é‡è½½
    hmr: true,

    // å°†æµè§ˆå™¨çš„æ§åˆ¶å°æ—¥å¿—å›æ˜¾åˆ°ç»ˆç«¯
    console: true,
  },

  routes: {
    "/": homepage,
  },
});
```

å½“è®¾ç½®`console: true`æ—¶ï¼ŒBunå°†ä»æµè§ˆå™¨æµå¼ä¼ è¾“æ§åˆ¶å°æ—¥å¿—åˆ°ç»ˆç«¯ã€‚è¿™é‡ç”¨HMRçš„ç°æœ‰WebSocketè¿æ¥æ¥å‘é€æ—¥å¿—ã€‚

### å¼€å‘ä¸ç”Ÿäº§

| ç‰¹æ€§             | å¼€å‘           | ç”Ÿäº§  |
| ------------------- | --------------------- | ----------- |
| **æºæ˜ å°„**     | âœ… å¯ç”¨            | âŒ ç¦ç”¨ |
| **å‹ç¼©**    | âŒ ç¦ç”¨           | âœ… å¯ç”¨  |
| **çƒ­é‡è½½**   | âœ… å¯ç”¨            | âŒ ç¦ç”¨ |
| **èµ„æºæ‰“åŒ…**  | ğŸ”„ æ¯ä¸ªè¯·æ±‚    | ğŸ’¾ ç¼“å­˜   |
| **æ§åˆ¶å°æ—¥å¿—** | ğŸ–¥ï¸ æµè§ˆå™¨ â†’ ç»ˆç«¯ | âŒ ç¦ç”¨ |
| **é”™è¯¯è¯¦æƒ…**   | ğŸ“ è¯¦ç»†           | ğŸ”’ æœ€å°  |

## ç”Ÿäº§æ¨¡å¼

çƒ­é‡è½½å’Œ`development: true`å¸®åŠ©æ‚¨å¿«é€Ÿè¿­ä»£ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ‚¨çš„æœåŠ¡å™¨åº”è¯¥å°½å¯èƒ½å¿«ï¼Œå¹¶ä¸”å¤–éƒ¨ä¾èµ–å°½å¯èƒ½å°‘ã€‚

### é¢„å…ˆæ‰“åŒ…ï¼ˆæ¨èï¼‰

ä»Bun v1.2.17å¼€å§‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`Bun.build`æˆ–`bun build`é¢„å…ˆæ‰“åŒ…å…¨æ ˆåº”ç”¨ç¨‹åºã€‚

```bash terminal icon="terminal"
bun build --target=bun --production --outdir=dist ./src/index.ts
```

å½“Bunçš„æ‰“åŒ…å™¨çœ‹åˆ°æœåŠ¡å™¨ç«¯ä»£ç ä¸­çš„HTMLå¯¼å…¥æ—¶ï¼Œå®ƒä¼šå°†å¼•ç”¨çš„JavaScript/TypeScript/TSX/JSXå’ŒCSSæ–‡ä»¶æ‰“åŒ…åˆ°ä¸€ä¸ªæ¸…å•å¯¹è±¡ä¸­ï¼Œ`Bun.serve()`å¯ä»¥ä½¿ç”¨è¯¥å¯¹è±¡æ¥æä¾›èµ„æºã€‚

```ts title="src/backend.ts" icon="/icons/typescript.svg"
import { serve } from "bun";
import index from "./index.html";

serve({
  routes: { "/": index },
});
```

### è¿è¡Œæ—¶æ‰“åŒ…

å½“æ·»åŠ æ„å»ºæ­¥éª¤è¿‡äºå¤æ‚æ—¶ï¼Œæ‚¨å¯ä»¥åœ¨`Bun.serve()`ä¸­è®¾ç½®`development: false`ã€‚

è¿™å°†ï¼š

- å¯ç”¨æ‰“åŒ…èµ„æºçš„å†…å­˜ç¼“å­˜ã€‚Bunå°†åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚`.html`æ–‡ä»¶æ—¶å»¶è¿Ÿæ‰“åŒ…èµ„æºï¼Œå¹¶å°†ç»“æœç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°æœåŠ¡å™¨é‡å¯ã€‚
- å¯ç”¨`Cache-Control`å¤´å’Œ`ETag`å¤´
- å‹ç¼©JavaScript/TypeScript/TSX/JSXæ–‡ä»¶

```ts title="src/backend.ts" icon="/icons/typescript.svg"
import { serve } from "bun";
import homepage from "./index.html";

serve({
  routes: {
    "/": homepage,
  },

  // ç”Ÿäº§æ¨¡å¼
  development: false,
});
```

## APIè·¯ç”±

### HTTPæ–¹æ³•å¤„ç†å™¨

ä½¿ç”¨HTTPæ–¹æ³•å¤„ç†å™¨å®šä¹‰APIç«¯ç‚¹ï¼š

```ts title="src/backend.ts" icon="/icons/typescript.svg"
import { serve } from "bun";

serve({
  routes: {
    "/api/users": {
      async GET(req) {
        // å¤„ç†GETè¯·æ±‚
        const users = await getUsers();
        return Response.json(users);
      },

      async POST(req) {
        // å¤„ç†POSTè¯·æ±‚
        const userData = await req.json();
        const user = await createUser(userData);
        return Response.json(user, { status: 201 });
      },

      async PUT(req) {
        // å¤„ç†PUTè¯·æ±‚
        const userData = await req.json();
        const user = await updateUser(userData);
        return Response.json(user);
      },

      async DELETE(req) {
        // å¤„ç†DELETEè¯·æ±‚
        await deleteUser(req.params.id);
        return new Response(null, { status: 204 });
      },
    },
  },
});
```

### åŠ¨æ€è·¯ç”±

åœ¨è·¯ç”±ä¸­ä½¿ç”¨URLå‚æ•°ï¼š

```ts title="src/backend.ts" icon="/icons/typescript.svg"
serve({
  routes: {
    // å•ä¸ªå‚æ•°
    "/api/users/:id": async req => {
      const { id } = req.params;
      const user = await getUserById(id);
      return Response.json(user);
    },

    // å¤šä¸ªå‚æ•°
    "/api/users/:userId/posts/:postId": async req => {
      const { userId, postId } = req.params;
      const post = await getPostByUser(userId, postId);
      return Response.json(post);
    },

    // é€šé…ç¬¦è·¯ç”±
    "/api/files/*": async req => {
      const filePath = req.params["*"];
      const file = await getFile(filePath);
      return new Response(file);
    },
  },
});
```

### è¯·æ±‚å¤„ç†

``ts title="src/backend.ts" icon="/icons/typescript.svg"
serve({
  routes: {
    "/api/data": {
      async POST(req) {
        // è§£æJSONä¸»ä½“
        const body = await req.json();

        // è®¿é—®å¤´
        const auth = req.headers.get("Authorization");

        // è®¿é—®URLå‚æ•°
        const { id } = req.params;

        // è®¿é—®æŸ¥è¯¢å‚æ•°
        const url = new URL(req.url);
        const page = url.searchParams.get("page") || "1";

        // è¿”å›å“åº”
        return Response.json({
          message: "Data processed",
          page: parseInt(page),
          authenticated: !!auth,
        });
      },
    },
  },
});
```

## æ’ä»¶

åœ¨æ‰“åŒ…é™æ€è·¯ç”±æ—¶ï¼Œä¹Ÿæ”¯æŒBunçš„æ‰“åŒ…å™¨æ’ä»¶ã€‚

è¦ä¸º`Bun.serve`é…ç½®æ’ä»¶ï¼Œè¯·åœ¨`bunfig.toml`çš„`[serve.static]`éƒ¨åˆ†æ·»åŠ ä¸€ä¸ª`plugins`æ•°ç»„ã€‚

### TailwindCSSæ’ä»¶

æ‚¨å¯ä»¥é€šè¿‡å®‰è£…å¹¶æ·»åŠ `tailwindcss`åŒ…å’Œ`bun-plugin-tailwind`æ’ä»¶æ¥ä½¿ç”¨TailwindCSSã€‚

```bash terminal icon="terminal"
bun add tailwindcss bun-plugin-tailwind
```

```toml title="bunfig.toml" icon="settings"
[serve.static]
plugins = ["bun-plugin-tailwind"]
```

è¿™å°†å…è®¸æ‚¨åœ¨HTMLå’ŒCSSæ–‡ä»¶ä¸­ä½¿ç”¨TailwindCSSå®ç”¨ç±»ã€‚æ‚¨åªéœ€è¦åœ¨æŸå¤„å¯¼å…¥`tailwindcss`ï¼š

``html title="index.html" icon="file-code"
<!doctype html>
<html>
  <head>
    <!-- [!code ++] -->
    <link rel="stylesheet" href="tailwindcss" />
  </head>
  <!-- the rest of your HTML... -->
</html>
```

æˆ–è€…ï¼Œæ‚¨å¯ä»¥åœ¨CSSæ–‡ä»¶ä¸­å¯¼å…¥TailwindCSSï¼š

``css title="style.css" icon="file-code"
@import "tailwindcss";

.custom-class {
  @apply bg-red-500 text-white;
}
```

```html index.html icon="file-code"
<!doctype html>
<html>
  <head>
    <!-- [!code ++] -->
    <link rel="stylesheet" href="./style.css" />
  </head>
  <!-- the rest of your HTML... -->
</html>
```

### è‡ªå®šä¹‰æ’ä»¶

ä»»ä½•å¯¼å‡ºæœ‰æ•ˆæ‰“åŒ…å™¨æ’ä»¶å¯¹è±¡ï¼ˆæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå…·æœ‰`name`å’Œ`setup`å­—æ®µçš„å¯¹è±¡ï¼‰çš„JSæ–‡ä»¶æˆ–æ¨¡å—éƒ½å¯ä»¥æ”¾åœ¨æ’ä»¶æ•°ç»„ä¸­ï¼š

``toml title="bunfig.toml" icon="settings"
[serve.static]
plugins = ["./my-plugin-implementation.ts"]
```

```ts title="my-plugin-implementation.ts" icon="/icons/typescript.svg"
import type { BunPlugin } from "bun";

const myPlugin: BunPlugin = {
  name: "my-custom-plugin",
  setup(build) {
    // æ’ä»¶å®ç°
    build.onLoad({ filter: /\.custom$/ }, async args => {
      const text = await Bun.file(args.path).text();
      return {
        contents: `export default ${JSON.stringify(text)};`,
        loader: "js",
      };
    });
  },
};

export default myPlugin;
```

Bunå°†å»¶è¿Ÿè§£æå’ŒåŠ è½½æ¯ä¸ªæ’ä»¶ï¼Œå¹¶ä½¿ç”¨å®ƒä»¬æ¥æ‰“åŒ…æ‚¨çš„è·¯ç”±ã€‚

<Note>
  ç›®å‰è¿™åœ¨`bunfig.toml`ä¸­ï¼Œä»¥ä¾¿åœ¨æˆ‘ä»¬æœ€ç»ˆå°†æ­¤åŠŸèƒ½ä¸`bun build` CLIé›†æˆæ—¶ï¼Œå¯ä»¥é™æ€åœ°çŸ¥é“ä½¿ç”¨äº†å“ªäº›æ’ä»¶ã€‚è¿™äº›æ’ä»¶åœ¨`Bun.build()`çš„JS APIä¸­å·¥ä½œï¼Œä½†CLIä¸­å°šä¸æ”¯æŒã€‚
</Note>

## å†…è”ç¯å¢ƒå˜é‡

Bunå¯ä»¥åœ¨æ„å»ºæ—¶å°†å‰ç«¯JavaScriptå’ŒTypeScriptä¸­çš„`process.env.*`å¼•ç”¨æ›¿æ¢ä¸ºå®ƒä»¬çš„å®é™…å€¼ã€‚åœ¨`bunfig.toml`ä¸­é…ç½®`env`é€‰é¡¹ï¼š

``toml title="bunfig.toml" icon="settings"
[serve.static]
env = "PUBLIC_*"  # åªå†…è”ä»¥PUBLIC_å¼€å¤´çš„ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰
# env = "inline"  # å†…è”æ‰€æœ‰ç¯å¢ƒå˜é‡
# env = "disable" # ç¦ç”¨ç¯å¢ƒå˜é‡æ›¿æ¢ï¼ˆé»˜è®¤ï¼‰
```

<Note>
  è¿™ä»…é€‚ç”¨äºå­—é¢é‡`process.env.FOO`å¼•ç”¨ï¼Œä¸é€‚ç”¨äº`import.meta.env`æˆ–é—´æ¥è®¿é—®å¦‚`const env =
  process.env; env.FOO`ã€‚

å¦‚æœæœªè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ‚¨å¯èƒ½ä¼šåœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°è¿è¡Œæ—¶é”™è¯¯ï¼Œå¦‚`ReferenceError: process
  is not defined`ã€‚

</Note>

æœ‰å…³æ„å»ºæ—¶é…ç½®å’Œç¤ºä¾‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§[HTMLå’Œé™æ€ç«™ç‚¹æ–‡æ¡£](/bundler/html-static#inline-environment-variables)ã€‚

## å·¥ä½œåŸç†

Bunä½¿ç”¨`HTMLRewriter`æ‰«æHTMLæ–‡ä»¶ä¸­çš„`<script>`å’Œ`<link>`æ ‡ç­¾ï¼Œå°†å®ƒä»¬ç”¨ä½œBunæ‰“åŒ…å™¨çš„å…¥å£ç‚¹ï¼Œä¸ºJavaScript/TypeScript/TSX/JSXå’ŒCSSæ–‡ä»¶ç”Ÿæˆä¼˜åŒ–çš„åŒ…ï¼Œå¹¶æä¾›ç»“æœã€‚

### å¤„ç†æµæ°´çº¿

<Steps>
<Step title="1. <script> å¤„ç†">
- è½¬è¯‘`<script>`æ ‡ç­¾ä¸­çš„TypeScriptã€JSXå’ŒTSX
- æ‰“åŒ…å¯¼å…¥çš„ä¾èµ–é¡¹
- ç”Ÿæˆæºæ˜ å°„ä»¥è¿›è¡Œè°ƒè¯•
- å½“`Bun.serve()`ä¸­`development`ä¸ä¸º`true`æ—¶è¿›è¡Œå‹ç¼©

```html title="index.html" icon="file-code"
<script type="module" src="./counter.tsx"></script>
```

</Step>
<Step title="2. <link> å¤„ç†">
- å¤„ç†CSSå¯¼å…¥å’Œ`<link>`æ ‡ç­¾
- è¿æ¥CSSæ–‡ä»¶
- é‡å†™URLå’Œèµ„æºè·¯å¾„ï¼Œä»¥ä¾¿åœ¨URLä¸­åŒ…å«å†…å®¹å¯å¯»å€å“ˆå¸Œ

```html title="index.html" icon="file-code"
<link rel="stylesheet" href="./styles.css" />
```

</Step>
<Step title="3. <img> å’Œèµ„æºå¤„ç†">
- é‡å†™èµ„æºé“¾æ¥ï¼Œä»¥ä¾¿åœ¨URLä¸­åŒ…å«å†…å®¹å¯å¯»å€å“ˆå¸Œ
- CSSæ–‡ä»¶ä¸­çš„å°èµ„æºè¢«å†…è”åˆ°`data:` URLä¸­ï¼Œå‡å°‘äº†ä¼ è¾“çš„HTTPè¯·æ±‚æ•°é‡
</Step>
<Step title="4. HTMLé‡å†™">
- å°†æ‰€æœ‰`<script>`æ ‡ç­¾åˆå¹¶ä¸ºä¸€ä¸ªåŒ…å«URLä¸­å†…å®¹å¯å¯»å€å“ˆå¸Œçš„`<script>`æ ‡ç­¾
- å°†æ‰€æœ‰`<link>`æ ‡ç­¾åˆå¹¶ä¸ºä¸€ä¸ªåŒ…å«URLä¸­å†…å®¹å¯å¯»å€å“ˆå¸Œçš„`<link>`æ ‡ç­¾
- è¾“å‡ºæ–°çš„HTMLæ–‡ä»¶
</Step>
<Step title="5. æä¾›æœåŠ¡">
- æ‰“åŒ…å™¨çš„æ‰€æœ‰è¾“å‡ºæ–‡ä»¶éƒ½ä½œä¸ºé™æ€è·¯ç”±æš´éœ²ï¼Œä½¿ç”¨ä¸å°†Responseå¯¹è±¡ä¼ é€’ç»™`Bun.serve()`ä¸­çš„`static`æ—¶ç›¸åŒçš„å†…éƒ¨æœºåˆ¶ã€‚
- è¿™ç±»ä¼¼äº`Bun.build`å¦‚ä½•å¤„ç†HTMLæ–‡ä»¶ã€‚
</Step>
</Steps>

## å®Œæ•´ç¤ºä¾‹

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„å…¨æ ˆåº”ç”¨ç¨‹åºç¤ºä¾‹ï¼š

``ts title="server.ts" icon="/icons/typescript.svg"
import { serve } from "bun";
import { Database } from "bun:sqlite";
import homepage from "./public/index.html";
import dashboard from "./public/dashboard.html";

// åˆå§‹åŒ–æ•°æ®åº“
const db = new Database("app.db");
db.exec(`
  CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
  )
`);

const server = serve({
  routes: {
    // å‰ç«¯è·¯ç”±
    "/": homepage,
    "/dashboard": dashboard,

    // APIè·¯ç”±
    "/api/users": {
      async GET() {
        const users = db.query("SELECT * FROM users").all();
        return Response.json(users);
      },

      async POST(req) {
        const { name, email } = await req.json();

        try {
          const result = db.query("INSERT INTO users (name, email) VALUES (?, ?) RETURNING *").get(name, email);

          return Response.json(result, { status: 201 });
        } catch (error) {
          return Response.json({ error: "Email already exists" }, { status: 400 });
        }
      },
    },

    "/api/users/:id": {
      async GET(req) {
        const { id } = req.params;
        const user = db.query("SELECT * FROM users WHERE id = ?").get(id);

        if (!user) {
          return Response.json({ error: "User not found" }, { status: 404 });
        }

        return Response.json(user);
      },

      async DELETE(req) {
        const { id } = req.params;
        const result = db.query("DELETE FROM users WHERE id = ?").run(id);

        if (result.changes === 0) {
          return Response.json({ error: "User not found" }, { status: 404 });
        }

        return new Response(null, { status: 204 });
      },
    },

    // å¥åº·æ£€æŸ¥ç«¯ç‚¹
    "/api/health": {
      GET() {
        return Response.json({
          status: "ok",
          timestamp: new Date().toISOString(),
        });
      },
    },
  },

  // å¯ç”¨å¼€å‘æ¨¡å¼
  development: {
    hmr: true,
    console: true,
  },

  // æœªåŒ¹é…è·¯ç”±çš„å›é€€
  fetch(req) {
    return new Response("Not Found", { status: 404 });
  },
});

console.log(`ğŸš€ Server running on ${server.url}`);
```

```html title="public/index.html" icon="file-code"
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Fullstack Bun App</title>
    <link rel="stylesheet" href="../src/styles.css" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="../src/main.tsx"></script>
  </body>
</html>
```

```tsx title="src/main.tsx"
import { createRoot } from "react-dom/client";
import { App } from "./App";

const container = document.getElementById("root")!;
const root = createRoot(container);
root.render(<App />);
```

```tsx title="src/App.tsx"
import { useState, useEffect } from "react";

interface User {
  id: number;
  name: string;
  email: string;
  created_at: string;
}

export function App() {
  const [users, setUsers] = useState<User[]>([]);
  const [name, setName] = useState("");
  const [email, setEmail] = useState("");
  const [loading, setLoading] = useState(false);

  const fetchUsers = async () => {
    const response = await fetch("/api/users");
    const data = await response.json();
    setUsers(data);
  };

  const createUser = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);

    try {
      const response = await fetch("/api/users", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, email }),
      });

      if (response.ok) {
        setName("");
        setEmail("");
        await fetchUsers();
      } else {
        const error = await response.json();
        alert(error.error);
      }
    } catch (error) {
      alert("Failed to create user");
    } finally {
      setLoading(false);
    }
  };

  const deleteUser = async (id: number) => {
    if (!confirm("Are you sure?")) return;

    try {
      const response = await fetch(`/api/users/${id}`, {
        method: "DELETE",
      });

      if (response.ok) {
        await fetchUsers();
      }
    } catch (error) {
      alert("Failed to delete user");
    }
  };

  useEffect(() => {
    fetchUsers();
  }, []);

  return (
    <div className="container">
      <h1>User Management</h1>

      <form onSubmit={createUser} className="form">
        <input type="text" placeholder="Name" value={name} onChange={e => setName(e.target.value)} required />
        <input type="email" placeholder="Email" value={email} onChange={e => setEmail(e.target.value)} required />
        <button type="submit" disabled={loading}>
          {loading ? "Creating..." : "Create User"}
        </button>
      </form>

      <div className="users">
        <h2>Users ({users.length})</h2>
        {users.map(user => (
          <div key={user.id} className="user-card">
            <div>
              <strong>{user.name}</strong>
              <br />
              <span>{user.email}</span>
            </div>
            <button onClick={() => deleteUser(user.id)} className="delete-btn">
              Delete
            </button>
          </div>
        ))}
      </div>
    </div>
  );
}
```

```css title="src/styles.css" icon="file-code"
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f5f5f5;
  color: #333;
}

.container {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
}

h1 {
  color: #2563eb;
  margin-bottom: 2rem;
}

.form {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  margin-bottom: 2rem;
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.form input {
  flex: 1;
  min-width: 200px;
  padding: 0.75rem;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.form button {
  padding: 0.75rem 1.5rem;
  background: #2563eb;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.form button:hover {
  background: #1d4ed8;
}

.form button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.users {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.user-card {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  border-bottom: 1px solid #eee;
}

.user-card:last-child {
  border-bottom: none;
}

.delete-btn {
  padding: 0.5rem 1rem;
  background: #dc2626;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.delete-btn:hover {
  background: #b91c1c;
}
```

## æœ€ä½³å®è·µ

### é¡¹ç›®ç»“æ„

```
my-app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â””â”€â”€ UserList.tsx
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â”œâ”€â”€ globals.css
â”‚   â”‚   â””â”€â”€ components.css
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”œâ”€â”€ App.tsx
â”‚   â””â”€â”€ main.tsx
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ dashboard.html
â”‚   â””â”€â”€ favicon.ico
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ users.ts
â”‚   â”‚   â””â”€â”€ auth.ts
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â””â”€â”€ schema.sql
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ bunfig.toml
â””â”€â”€ package.json
```

### åŸºäºç¯å¢ƒçš„é…ç½®

``ts title="server/config.ts" icon="/icons/typescript.svg"
export const config = {
  development: process.env.NODE_ENV !== "production",
  port: process.env.PORT || 3000,
  database: {
    url: process.env.DATABASE_URL || "./dev.db",
  },
  cors: {
    origin: process.env.CORS_ORIGIN || "*",
  },
};
```

### é”™è¯¯å¤„ç†

``ts title="server/middleware.ts" icon="/icons/typescript.svg"
export function errorHandler(error: Error, req: Request) {
  console.error("Server error:", error);

  if (process.env.NODE_ENV === "production") {
    return Response.json({ error: "Internal server error" }, { status: 500 });
  }

  return Response.json(
    {
      error: error.message,
      stack: error.stack,
    },
    { status: 500 },
  );
}
```

### APIå“åº”è¾…åŠ©

``ts title="server/utils.ts" icon="/icons/typescript.svg"
export function json(data: any, status = 200) {
  return Response.json(data, { status });
}

export function error(message: string, status = 400) {
  return Response.json({ error: message }, { status });
}

export function notFound(message = "Not found") {
  return error(message, 404);
}

export function unauthorized(message = "Unauthorized") {
  return error(message, 401);
}
```

### ç±»å‹å®‰å…¨

``ts title="types/api.ts" icon="/icons/typescript.svg"
export interface User {
  id: number;
  name: string;
  email: string;
  created_at: string;
}

export interface CreateUserRequest {
  name: string;
  email: string;
}

export interface ApiResponse<T> {
  data?: T;
  error?: string;
}
```

## éƒ¨ç½²

### ç”Ÿäº§æ„å»º

``bash terminal icon="terminal"
# Build for production
bun build --target=bun --production --outdir=dist ./server/index.ts

# Run production server
NODE_ENV=production bun dist/index.js
```

### Dockeréƒ¨ç½²

``dockerfile title="Dockerfile" icon="docker"
FROM oven/bun:1 as base
WORKDIR /usr/src/app

# Install dependencies
COPY package.json bun.lockb ./
RUN bun install --frozen-lockfile

# Copy source code
COPY . .

# Build application
RUN bun build --target=bun --production --outdir=dist ./server/index.ts

# Production stage
FROM oven/bun:1-slim
WORKDIR /usr/src/app
COPY --from=base /usr/src/app/dist ./
COPY --from=base /usr/src/app/public ./public

EXPOSE 3000
CMD ["bun", "index.js"]
```

### ç¯å¢ƒå˜é‡

``ini title=".env.production" icon="file-code"
NODE_ENV=production
PORT=3000
DATABASE_URL=postgresql://user:pass@localhost:5432/myapp
CORS_ORIGIN=https://myapp.com
```

## ä»å…¶ä»–æ¡†æ¶è¿ç§»

### ä»Express + Webpack

``ts title="server.ts" icon="/icons/typescript.svg"
// Before (Express + Webpack)
app.use(express.static("dist"));
app.get("/api/users", (req, res) => {
  res.json(users);
});

// After (Bun fullstack)
serve({
  routes: {
    "/": homepage, // Replaces express.static
    "/api/users": {
      GET() {
        return Response.json(users);
      },
    },
  },
});
```

### ä»Next.js API Routes

``ts title="server.ts" icon="/icons/typescript.svg"
// Before (Next.js)
export default function handler(req, res) {
  if (req.method === 'GET') {
    res.json(users);
  }
}

// After (Bun)
"/api/users": {
  GET() { return Response.json(users); }
}
```

## é™åˆ¶å’Œæœªæ¥è®¡åˆ’

### å½“å‰é™åˆ¶

- `bun build` CLIé›†æˆå°šæœªå¯ç”¨äºå…¨æ ˆåº”ç”¨ç¨‹åº
- APIè·¯ç”±çš„è‡ªåŠ¨å‘ç°å°šæœªå®ç°
- æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ä¸æ˜¯å†…ç½®çš„

### è®¡åˆ’ä¸­çš„åŠŸèƒ½

- ä¸`bun build` CLIé›†æˆ
- åŸºäºæ–‡ä»¶çš„APIç«¯ç‚¹è·¯ç”±
- å†…ç½®SSRæ”¯æŒ
- å¢å¼ºçš„æ’ä»¶ç”Ÿæ€ç³»ç»Ÿ

<Note>Bunæ­£åœ¨å¼€å‘ä¸­ã€‚éšç€Bunçš„ä¸æ–­å‘å±•ï¼ŒåŠŸèƒ½å’ŒAPIå¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚</Note>
