---
title: åœ¨ Bun ä¸­ä½¿ç”¨ Gel
sidebarTitle: Gel ä¸ Bun
mode: center
---

Gelï¼ˆåŸå EdgeDBï¼‰æ˜¯ä¸€ä¸ªå›¾å…³ç³»å‹æ•°æ®åº“ï¼Œåº•å±‚åŸºäº Postgresã€‚å®ƒæä¾›äº†å£°æ˜å¼æ¨¡å¼è¯­è¨€ã€è¿ç§»ç³»ç»Ÿå’Œé¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œæ­¤å¤–è¿˜æ”¯æŒåŸå§‹ SQL æŸ¥è¯¢ã€‚å®ƒåœ¨æ•°æ®åº“å±‚è§£å†³äº†å¯¹è±¡å…³ç³»æ˜ å°„é—®é¢˜ï¼Œæ¶ˆé™¤äº†åœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­éœ€è¦ ORM åº“çš„éœ€æ±‚ã€‚

---

é¦–å…ˆï¼Œå¦‚æœè¿˜æ²¡æœ‰å®‰è£…çš„è¯ï¼Œè¯·[å®‰è£… Gel](https://docs.geldata.com/learn/installation)ã€‚

<CodeGroup>

```sh Linux/macOS terminal icon="terminal"
curl https://www.geldata.com/sh --proto "=https" -sSf1 | sh
```

```sh Windows terminal icon="windows"
irm https://www.geldata.com/ps1 | iex
```

```sh Homebrew terminal icon="terminal"
brew install geldata/tap/gel-cli
```

</CodeGroup>

---

ä½¿ç”¨ `bun init` åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚

```sh terminal icon="terminal"
mkdir my-edgedb-app
cd my-edgedb-app
bun init -y
```

---

æˆ‘ä»¬å°†ä½¿ç”¨ Gel CLI ä¸ºæˆ‘ä»¬çš„é¡¹ç›®åˆå§‹åŒ–ä¸€ä¸ª Gel å®ä¾‹ã€‚è¿™ä¼šåœ¨æˆ‘ä»¬çš„é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª [gel.toml] æ–‡ä»¶ã€‚

```sh terminal icon="terminal"
gel project init
```

```txt
åœ¨ `/Users/colinmcd94/Documents/bun/fun/examples/my-gel-app` æˆ–å…¶ä¸Šçº§ç›®å½•æœªæ‰¾åˆ° `gel.toml`
æ˜¯å¦è¦åˆå§‹åŒ–ä¸€ä¸ªæ–°é¡¹ç›®ï¼Ÿ[Y/n]
> Y
æŒ‡å®šè¦ä¸æ­¤é¡¹ç›®ä¸€èµ·ä½¿ç”¨çš„ Gel å®ä¾‹åç§° [é»˜è®¤: my_gel_app]:
> my_gel_app
æ­£åœ¨æ£€æŸ¥ Gel ç‰ˆæœ¬...
æŒ‡å®šè¦ä¸æ­¤é¡¹ç›®ä¸€èµ·ä½¿ç”¨çš„ Gel ç‰ˆæœ¬ [é»˜è®¤: x.y]:
> x.y
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¡¹ç›®ç›®å½•             â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app          â”‚
â”‚ é¡¹ç›®é…ç½®             â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/gel.toml â”‚
â”‚ æ¨¡å¼ç›®å½•ï¼ˆç©ºï¼‰       â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/dbschema  â”‚
â”‚ å®‰è£…æ–¹æ³•             â”‚ portable package                                                 â”‚
â”‚ ç‰ˆæœ¬                 â”‚ x.y+6d5921b                                                      â”‚
â”‚ å®ä¾‹åç§°             â”‚ my_gel_app                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ç‰ˆæœ¬ x.y+6d5921b å·²ç»ä¸‹è½½
æ­£åœ¨åˆå§‹åŒ– Gel å®ä¾‹...
æ­£åœ¨åº”ç”¨è¿ç§»...
æ‰€æœ‰å†…å®¹éƒ½æ˜¯æœ€æ–°çš„ã€‚ä¿®è®¢ç‰ˆæœ¬ initial
é¡¹ç›®å·²åˆå§‹åŒ–ã€‚
è¦è¿æ¥åˆ° my_gel_appï¼Œè¯·è¿è¡Œ `gel`
```

---

è¦æŸ¥çœ‹æ•°æ®åº“æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Œè®©æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ª REPL å¹¶è¿è¡Œä¸€ä¸ªç®€å•æŸ¥è¯¢ã€‚

```sh terminal icon="terminal"
gel
gel> select 1 + 1;
```

```txt
2
```

ç„¶åè¿è¡Œ `\quit` é€€å‡º REPLã€‚

```sh terminal icon="terminal"
gel> \quit
```

---

é¡¹ç›®åˆå§‹åŒ–åï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ¨¡å¼ã€‚`gel project init` å‘½ä»¤å·²ç»åˆ›å»ºäº†ä¸€ä¸ª `dbschema/default.esdl` æ–‡ä»¶æ¥åŒ…å«æˆ‘ä»¬çš„æ¨¡å¼ã€‚

```txt File Tree icon="folder-tree"
dbschema
â”œâ”€â”€ default.esdl
â””â”€â”€ migrations
```

---

æ‰“å¼€è¯¥æ–‡ä»¶å¹¶ç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚

```ts default.esdl icon="file-code"
module default {
  type Movie {
    required title: str;
    releaseYear: int64;
  }
};
```

---

ç„¶åç”Ÿæˆå¹¶åº”ç”¨ä¸€ä¸ªåˆå§‹è¿ç§»ã€‚

```sh terminal icon="terminal"
gel migration create
```

```txt
Created /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/dbschema/migrations/00001.edgeql, id: m1uwekrn4ni4qs7ul7hfar4xemm5kkxlpswolcoyqj3xdhweomwjrq
```

```sh terminal icon="terminal"
gel migrate
```

```txt
Applied m1uwekrn4ni4qs7ul7hfar4xemm5kkxlpswolcoyqj3xdhweomwjrq (00001.edgeql)
```

---

æ¨¡å¼åº”ç”¨åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ Gel çš„ JavaScript å®¢æˆ·ç«¯åº“æ‰§è¡Œä¸€äº›æŸ¥è¯¢ã€‚æˆ‘ä»¬å°†å®‰è£…å®¢æˆ·ç«¯åº“å’Œ Gel çš„ä»£ç ç”Ÿæˆ CLIï¼Œå¹¶åˆ›å»ºä¸€ä¸ª [seed.ts] æ–‡ä»¶ã€‚

```sh terminal icon="terminal"
bun add gel
bun add -D @gel/generate
touch seed.ts
```

---

å°†ä»¥ä¸‹ä»£ç ç²˜è´´åˆ° [seed.ts] ä¸­ã€‚

å®¢æˆ·ç«¯è‡ªåŠ¨è¿æ¥åˆ°æ•°æ®åº“ã€‚æˆ‘ä»¬ä½¿ç”¨ `.execute()` æ–¹æ³•æ’å…¥ä¸€äº›ç”µå½±ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ EdgeQL çš„ `for` è¡¨è¾¾å¼å°†æ­¤æ‰¹é‡æ’å…¥è½¬æ¢ä¸ºå•ä¸ªä¼˜åŒ–æŸ¥è¯¢ã€‚

```ts seed.ts icon="/icons/typescript.svg"
import { createClient } from "gel";

const client = createClient();

const INSERT_MOVIE = `
  with movies := <array<tuple<title: str, year: int64>>>$movies
  for movie in array_unpack(movies) union (
    insert Movie {
      title := movie.title,
      releaseYear := movie.year,
    }
  )
`;

const movies = [
  { title: "The Matrix", year: 1999 },
  { title: "The Matrix Reloaded", year: 2003 },
  { title: "The Matrix Revolutions", year: 2003 },
];

await client.execute(INSERT_MOVIE, { movies });

console.log(`æ’­ç§å®Œæˆã€‚`);
process.exit();
```

---

ç„¶åä½¿ç”¨ Bun è¿è¡Œæ­¤æ–‡ä»¶ã€‚

```sh terminal icon="terminal"
bun run seed.ts
```

```txt
æ’­ç§å®Œæˆã€‚
```

---

Gel å®ç°äº†è®¸å¤šç”¨äº TypeScript çš„ä»£ç ç”Ÿæˆå·¥å…·ã€‚ä¸ºäº†ä»¥ç±»å‹å®‰å…¨çš„æ–¹å¼æŸ¥è¯¢æˆ‘ä»¬åˆšå¡«å……çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ `@gel/generate` æ¥ä»£ç ç”Ÿæˆ EdgeQL æŸ¥è¯¢æ„å»ºå™¨ã€‚

```sh terminal icon="terminal"
bunx @gel/generate edgeql-js
```

```txt
æ­£åœ¨ç”ŸæˆæŸ¥è¯¢æ„å»ºå™¨...
æ£€æµ‹åˆ° tsconfig.jsonï¼Œæ­£åœ¨ç”Ÿæˆ TypeScript æ–‡ä»¶ã€‚
   è¦è¦†ç›–æ­¤è¡Œä¸ºï¼Œè¯·ä½¿ç”¨ --target æ ‡å¿—ã€‚
   è¿è¡Œ `npx @edgedb/generate --help` è·å–å®Œæ•´é€‰é¡¹ã€‚
æ­£åœ¨æ£€æŸ¥æ•°æ®åº“æ¨¡å¼...
æ­£åœ¨å°†æ–‡ä»¶å†™å…¥ ./dbschema/edgeql-js
ç”Ÿæˆå®Œæˆï¼ğŸ¤˜
ä¸å»ºè®®å°†ç”Ÿæˆçš„æŸ¥è¯¢æ„å»ºå™¨æ£€å…¥ç‰ˆæœ¬æ§åˆ¶
æ‚¨æ˜¯å¦æƒ³æ›´æ–° .gitignore ä»¥å¿½ç•¥
æŸ¥è¯¢æ„å»ºå™¨ç›®å½•ï¼Ÿä»¥ä¸‹è¡Œå°†è¢«æ·»åŠ ï¼š

   dbschema/edgeql-js

[y/n] ï¼ˆç•™ç©ºè¡¨ç¤º "y"ï¼‰
> y
```

---

åœ¨ [index.ts] ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä» `./dbschema/edgeql-js` å¯¼å…¥ç”Ÿæˆçš„æŸ¥è¯¢æ„å»ºå™¨å¹¶ç¼–å†™ä¸€ä¸ªç®€å•çš„é€‰æ‹©æŸ¥è¯¢ã€‚

```ts index.ts icon="/icons/typescript.svg"
import { createClient } from "gel";
import e from "./dbschema/edgeql-js";

const client = createClient();

const query = e.select(e.Movie, () => ({
  title: true,
  releaseYear: true,
}));

const results = await query.run(client);
console.log(results);

results; // { title: string, releaseYear: number | null }[]
```

---

ä½¿ç”¨ Bun è¿è¡Œè¯¥æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ’å…¥çš„ç”µå½±åˆ—è¡¨ã€‚

```sh terminal icon="terminal"
bun run index.ts
```

```txt
[
  {
    title: "The Matrix",
    releaseYear: 1999
  }, {
    title: "The Matrix Reloaded",
    releaseYear: 2003
  }, {
    title: "The Matrix Revolutions",
    releaseYear: 2003
  }
]
```

---

æœ‰å…³å®Œæ•´æ–‡æ¡£ï¼Œè¯·å‚é˜… [Gel æ–‡æ¡£](https://docs.geldata.com/)ã€‚
