var h=function(M){return new __GlobalBunCString(M)},T=function(M,E,$,j){const q=typeof FFIType[E]==="number"&&FFIType[E]!==FFIType.void;var z=new Array(M.length),G=new Array(M.length);for(let P=0;P<M.length;P++){z[P]=`p${P}`;const Q=A[FFIType[M[P]]];if(Q)G[P]=`(${Q.toString()})(p${P})`;else throw new TypeError(`Unsupported type ${M[P]}. Must be one of: ${Object.keys(FFIType).sort().join(", ")}`)}var H=`functionToCall(${G.join(", ")})`;if(q)if(FFIType[E]===FFIType.cstring)H=`return (${h.toString()})(${H})`;else H=`return ${H}`;var J=new Function("functionToCall",...z,H);Object.defineProperty(J,"name",{value:j});var K;switch(z.length){case 0:K=()=>J($);break;case 1:K=(P)=>J($,P);break;case 2:K=(P,Q)=>J($,P,Q);break;case 3:K=(P,Q,U)=>J($,P,Q,U);break;case 4:K=(P,Q,U,V)=>J($,P,Q,U,V);break;case 5:K=(P,Q,U,V,X)=>J($,P,Q,U,V,X);break;case 6:K=(P,Q,U,V,X,Y)=>J($,P,Q,U,V,X,Y);break;case 7:K=(P,Q,U,V,X,Y,Z)=>J($,P,Q,U,V,X,Y,Z);break;case 8:K=(P,Q,U,V,X,Y,Z,D)=>J($,P,Q,U,V,X,Y,Z,D);break;case 9:K=(P,Q,U,V,X,Y,Z,D,_)=>J($,P,Q,U,V,X,Y,Z,D,_);break;default:{K=(...P)=>J($,...P);break}}return K.native=$,K.ptr=$.ptr,K};function y(M,E){const $=w(M,E);for(let q in $.symbols){var j=$.symbols[q];if(E[q]?.args?.length||FFIType[E[q]?.returns]===FFIType.cstring)$.symbols[q]=T(E[q].args??[],E[q].returns??FFIType.void,j,M.includes("/")?`${q} (${M.split("/").pop()})`:`${q} (${M})`);else $.symbols[q].native=$.symbols[q]}return $}function c(M){const E=L(M);for(let j in E.symbols){var $=E.symbols[j];if(M[j]?.args?.length||FFIType[M[j]?.returns]===FFIType.cstring)E.symbols[j]=T(M[j].args??[],M[j].returns??FFIType.void,$,j);else E.symbols[j].native=E.symbols[j]}return E}var s=function(M){M()};function i(M){const E=`CFunction${u++}`;var $=c({[E]:M}),j=!1,q=$.close;return $.symbols[E].close=()=>{if(j||!q)return;j=!0,q(),q=void 0},F||=new FinalizationRegistry(s),F.register($.symbols[E],$.symbols[E].close),$.symbols[E]}var R="dylib",I=globalThis.Bun.FFI,x=(M,E)=>typeof E==="undefined"?I.ptr(M):I.ptr(M,E),S=I.toBuffer,B=I.toArrayBuffer,O=I.viewSource,N=I.CString,L=I.linkSymbols,w=I.dlopen,d=I.callback,W=I.closeCallback;delete I.callback;delete I.closeCallback;class m{constructor(M,E){const{ctx:$,ptr:j}=d(E,M);this.#M=$,this.ptr=j,this.#E=!!E?.threadsafe}ptr;#M;#E;get threadsafe(){return this.#E}[Symbol.toPrimitive](){const{ptr:M}=this;return typeof M==="number"?M:0}close(){const M=this.#M;if(this.ptr=null,this.#M=null,M)W(M)}}class k extends String{constructor(M,E,$){super(M?typeof $==="number"&&Number.isSafeInteger($)?new N(M,E||0,$):new N(M):"");if(this.ptr=typeof M==="number"?M:0,typeof E!=="undefined")this.byteOffset=E;if(typeof $!=="undefined")this.byteLength=$}ptr;byteOffset;byteLength;#M;get arrayBuffer(){if(this.#M)return this.#M;if(!this.ptr)return this.#M=new ArrayBuffer(0);return this.#M=B(this.ptr,this.byteOffset,this.byteLength)}}Object.defineProperty(globalThis,"__GlobalBunCString",{value:k,enumerable:!1,configurable:!1});var A=new Array(18),b=(M)=>M|0;A.fill(b);A[FFIType.uint8_t]=function M(E){return E<0?0:E>=255?255:E|0};A[FFIType.int16_t]=function M(E){return E<=-32768?-32768:E>=32768?32768:E|0};A[FFIType.uint16_t]=function M(E){return E<=0?0:E>=65536?65536:E|0};A[FFIType.int32_t]=function M(E){return E|0};A[FFIType.uint32_t]=function M(E){return E<=0?0:E>=4294967295?4294967295:+E||0};A[FFIType.i64_fast]=function M(E){if(typeof E==="bigint"){if(E<=BigInt(Number.MAX_SAFE_INTEGER)&&E>=BigInt(-Number.MAX_SAFE_INTEGER))return Number(E).valueOf()||0;return E}return!E?0:+E||0};A[FFIType.u64_fast]=function M(E){if(typeof E==="bigint"){if(E<=BigInt(Number.MAX_SAFE_INTEGER)&&E>=0)return Number(E).valueOf()||0;return E}return!E?0:+E||0};A[FFIType.int64_t]=function M(E){if(typeof E==="bigint")return E;if(typeof E==="number")return BigInt(E||0);return BigInt(+E||0)};A[FFIType.uint64_t]=function M(E){if(typeof E==="bigint")return E;if(typeof E==="number")return E<=0?BigInt(0):BigInt(E||0);return BigInt(+E||0)};A[FFIType.u64_fast]=function M(E){if(typeof E==="bigint"){if(E<=BigInt(Number.MAX_SAFE_INTEGER)&&E>=BigInt(0))return Number(E);return E}return typeof E==="number"?E<=0?0:+E||0:+E||0};A[FFIType.uint16_t]=function M(E){const $=(typeof E==="bigint"?Number(E):E)|0;return $<=0?0:$>65535?65535:$};A[FFIType.double]=function M(E){if(typeof E==="bigint"){if(E.valueOf()<BigInt(Number.MAX_VALUE))return Math.abs(Number(E).valueOf())+0.00000000000001-0.00000000000001}if(!E)return 0;return E+0.00000000000001-0.00000000000001};A[FFIType.float]=A[10]=function M(E){return Math.fround(E)};A[FFIType.bool]=function M(E){return!!E};Object.defineProperty(globalThis,"__GlobalBunFFIPtrFunctionForWrapper",{value:x,enumerable:!1,configurable:!0});A[FFIType.cstring]=A[FFIType.pointer]=function M(E){if(typeof E==="number")return E;if(!E)return null;if(ArrayBuffer.isView(E)||E instanceof ArrayBuffer)return __GlobalBunFFIPtrFunctionForWrapper(E);if(typeof E==="string")throw new TypeError("To convert a string to a pointer, encode it as a buffer");throw new TypeError(`Unable to convert ${E} to a pointer`)};A[FFIType.function]=function M(E){if(typeof E==="number")return E;if(typeof E==="bigint")return Number(E);var $=E&&E.ptr;if(!$)throw new TypeError("Expected function to be a JSCallback or a number");return $};var C={dlopen:w,callback:()=>{throw new Error("Deprecated. Use new JSCallback(options, fn) instead")}},u=0,F,f=I.read;export{O as viewSource,S as toBuffer,B as toArrayBuffer,R as suffix,f as read,x as ptr,C as native,c as linkSymbols,y as dlopen,m as JSCallback,k as CString,i as CFunction};
