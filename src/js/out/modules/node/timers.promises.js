var f=function(h,q){if(h===null||typeof h!=="object")throw new B(q,"Object",h)},O=function(h,q){if(typeof h!=="boolean")throw new B(q,"boolean",h)},S=function(h,q){if(typeof h!=="undefined"&&(h===null||typeof h!=="object"||!("aborted"in h)))throw new B(q,"AbortSignal",h)},X=function({next:h,return:q}){const w={};if(typeof h==="function")w.next=h;if(typeof q==="function")w.return=q;return w[$]=function(){return this},w},T=function(h=1,q,w={}){const z=[].concat(q??[]);try{f(w,"options")}catch(Q){return Promise.reject(Q)}const{signal:H,ref:J=!0}=w;try{S(H,"options.signal")}catch(Q){return Promise.reject(Q)}try{O(J,"options.ref")}catch(Q){return Promise.reject(Q)}if(H?.aborted)return Promise.reject(new Z);let K;const M=new Promise((Q,U)=>{const W=setTimeout(()=>Q(q),h,...z);if(!J)W?.unref?.();if(H)K=()=>{clearTimeout(W),U(new Z)},H.addEventListener("abort",K)});if(typeof K!=="undefined")M.finally(()=>H.removeEventListener("abort",K));return M},x=function(h,q={}){try{f(q,"options")}catch(K){return Promise.reject(K)}const{signal:w,ref:z=!0}=q;try{S(w,"options.signal")}catch(K){return Promise.reject(K)}try{O(z,"options.ref")}catch(K){return Promise.reject(K)}if(w?.aborted)return Promise.reject(new Z);let H;const J=new Promise((K,M)=>{const Q=setImmediate(()=>K(h));if(!z)Q?.unref?.();if(w)H=()=>{clearImmediate(Q),M(new Z)},w.addEventListener("abort",H)});if(typeof H!=="undefined")J.finally(()=>w.removeEventListener("abort",H));return J},D=function(h=1,q,w={}){try{f(w,"options")}catch(M){return X({next:function(){return Promise.reject(M)}})}const{signal:z,ref:H=!0}=w;try{S(z,"options.signal")}catch(M){return X({next:function(){return Promise.reject(M)}})}try{O(H,"options.ref")}catch(M){return X({next:function(){return Promise.reject(M)}})}if(z?.aborted)return X({next:function(){return Promise.reject(new Z)}});let J,K;try{let M=0,Q;if(K=setInterval(()=>{if(M++,Q)Q(),Q=void 0},h),!H)K?.unref?.();if(z)J=()=>{if(clearInterval(K),Q)Q(),Q=void 0},z.addEventListener("abort",J);return X({next:function(){return new Promise((U,W)=>{if(!z?.aborted)if(M===0)Q=U;else U();else if(M===0)W(new Z);else U()}).then(()=>{if(M>0)return M=M-1,{done:!1,value:q};return{done:!0}})},return:function(){return clearInterval(K),z?.removeEventListener("abort",J),Promise.resolve({})}})}catch(M){return X({next:function(){clearInterval(K),z?.removeEventListener("abort",J)}})}},$=Symbol.asyncIterator;class B extends Error{constructor(h,q,w){super(`${h} must be ${q}, ${typeof w} given`);this.code="ERR_INVALID_ARG_TYPE"}}class Z extends Error{constructor(){super("The operation was aborted");this.code="ABORT_ERR"}}export{T as setTimeout,D as setInterval,x as setImmediate};
