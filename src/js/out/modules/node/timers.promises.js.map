{
  "version": 3,
  "sources": ["src/js/node/timers.promises.js"],
  "sourcesContent": [
    "// Hardcoded module \"node:timers/promises\"\n// https://github.com/niksy/isomorphic-timers-promises/blob/master/index.js\nconst symbolAsyncIterator = Symbol.asyncIterator;\n\nclass ERR_INVALID_ARG_TYPE extends Error {\n  constructor(name, expected, actual) {\n    super(`${name} must be ${expected}, ${typeof actual} given`);\n    this.code = \"ERR_INVALID_ARG_TYPE\";\n  }\n}\n\nclass AbortError extends Error {\n  constructor() {\n    super(\"The operation was aborted\");\n    this.code = \"ABORT_ERR\";\n  }\n}\n\nfunction validateObject(object, name) {\n  if (object === null || typeof object !== \"object\") {\n    throw new ERR_INVALID_ARG_TYPE(name, \"Object\", object);\n  }\n}\n\nfunction validateBoolean(value, name) {\n  if (typeof value !== \"boolean\") {\n    throw new ERR_INVALID_ARG_TYPE(name, \"boolean\", value);\n  }\n}\n\nfunction validateAbortSignal(signal, name) {\n  if (typeof signal !== \"undefined\" && (signal === null || typeof signal !== \"object\" || !(\"aborted\" in signal))) {\n    throw new ERR_INVALID_ARG_TYPE(name, \"AbortSignal\", signal);\n  }\n}\n\nfunction asyncIterator({ next: nextFunction, return: returnFunction }) {\n  const result = {};\n  if (typeof nextFunction === \"function\") {\n    result.next = nextFunction;\n  }\n  if (typeof returnFunction === \"function\") {\n    result.return = returnFunction;\n  }\n  result[symbolAsyncIterator] = function () {\n    return this;\n  };\n\n  return result;\n}\n\nfunction setTimeoutPromise(after = 1, value, options = {}) {\n  const arguments_ = [].concat(value ?? []);\n  try {\n    validateObject(options, \"options\");\n  } catch (error) {\n    return Promise.reject(error);\n  }\n  const { signal, ref: reference = true } = options;\n  try {\n    validateAbortSignal(signal, \"options.signal\");\n  } catch (error) {\n    return Promise.reject(error);\n  }\n  try {\n    validateBoolean(reference, \"options.ref\");\n  } catch (error) {\n    return Promise.reject(error);\n  }\n  if (signal?.aborted) {\n    return Promise.reject(new AbortError());\n  }\n  let onCancel;\n  const returnValue = new Promise((resolve, reject) => {\n    const timeout = setTimeout(() => resolve(value), after, ...arguments_);\n    if (!reference) {\n      timeout?.unref?.();\n    }\n    if (signal) {\n      onCancel = () => {\n        clearTimeout(timeout);\n        reject(new AbortError());\n      };\n      signal.addEventListener(\"abort\", onCancel);\n    }\n  });\n  if (typeof onCancel !== \"undefined\") {\n    returnValue.finally(() => signal.removeEventListener(\"abort\", onCancel));\n  }\n  return returnValue;\n}\n\nfunction setImmediatePromise(value, options = {}) {\n  try {\n    validateObject(options, \"options\");\n  } catch (error) {\n    return Promise.reject(error);\n  }\n  const { signal, ref: reference = true } = options;\n  try {\n    validateAbortSignal(signal, \"options.signal\");\n  } catch (error) {\n    return Promise.reject(error);\n  }\n  try {\n    validateBoolean(reference, \"options.ref\");\n  } catch (error) {\n    return Promise.reject(error);\n  }\n  if (signal?.aborted) {\n    return Promise.reject(new AbortError());\n  }\n  let onCancel;\n  const returnValue = new Promise((resolve, reject) => {\n    const immediate = setImmediate(() => resolve(value));\n    if (!reference) {\n      immediate?.unref?.();\n    }\n    if (signal) {\n      onCancel = () => {\n        clearImmediate(immediate);\n        reject(new AbortError());\n      };\n      signal.addEventListener(\"abort\", onCancel);\n    }\n  });\n  if (typeof onCancel !== \"undefined\") {\n    returnValue.finally(() => signal.removeEventListener(\"abort\", onCancel));\n  }\n  return returnValue;\n}\n\nfunction setIntervalPromise(after = 1, value, options = {}) {\n  /* eslint-disable no-undefined, no-unreachable-loop, no-loop-func */\n  try {\n    validateObject(options, \"options\");\n  } catch (error) {\n    return asyncIterator({\n      next: function () {\n        return Promise.reject(error);\n      },\n    });\n  }\n  const { signal, ref: reference = true } = options;\n  try {\n    validateAbortSignal(signal, \"options.signal\");\n  } catch (error) {\n    return asyncIterator({\n      next: function () {\n        return Promise.reject(error);\n      },\n    });\n  }\n  try {\n    validateBoolean(reference, \"options.ref\");\n  } catch (error) {\n    return asyncIterator({\n      next: function () {\n        return Promise.reject(error);\n      },\n    });\n  }\n  if (signal?.aborted) {\n    return asyncIterator({\n      next: function () {\n        return Promise.reject(new AbortError());\n      },\n    });\n  }\n\n  let onCancel, interval;\n\n  try {\n    let notYielded = 0;\n    let callback;\n    interval = setInterval(() => {\n      notYielded++;\n      if (callback) {\n        callback();\n        callback = undefined;\n      }\n    }, after);\n    if (!reference) {\n      interval?.unref?.();\n    }\n    if (signal) {\n      onCancel = () => {\n        clearInterval(interval);\n        if (callback) {\n          callback();\n          callback = undefined;\n        }\n      };\n      signal.addEventListener(\"abort\", onCancel);\n    }\n\n    return asyncIterator({\n      next: function () {\n        return new Promise((resolve, reject) => {\n          if (!signal?.aborted) {\n            if (notYielded === 0) {\n              callback = resolve;\n            } else {\n              resolve();\n            }\n          } else if (notYielded === 0) {\n            reject(new AbortError());\n          } else {\n            resolve();\n          }\n        }).then(() => {\n          if (notYielded > 0) {\n            notYielded = notYielded - 1;\n            return { done: false, value: value };\n          }\n          return { done: true };\n        });\n      },\n      return: function () {\n        clearInterval(interval);\n        signal?.removeEventListener(\"abort\", onCancel);\n        return Promise.resolve({});\n      },\n    });\n  } catch (error) {\n    return asyncIterator({\n      next: function () {\n        clearInterval(interval);\n        signal?.removeEventListener(\"abort\", onCancel);\n      },\n    });\n  }\n}\n\nexport { setTimeoutPromise as setTimeout, setImmediatePromise as setImmediate, setIntervalPromise as setInterval };\n"
  ],
  "mappings": "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",
  "debugId": "87F599DAC0291F4B64756e2164756e21",
  "names": []
}