/**
 * Exercises using `bun install` on the most used JavaScript repositories.
 */
import { describe, expect, test } from "bun:test";
import { bunExe, tempDir } from "harness";

const MAX_TIMEOUT_MS = 180 * 1000;

const PACKAGES_TO_TEST = [
  { name: "freeCodeCamp/freeCodeCamp", committish: "02e1e1c33180cd11591208ece5d021544699c8cb" },
  { name: "kamranahmedse/developer-roadmap", committish: "36f20b31f4f4f183c52eb2580eaf4ca8b873b3a5" },
  { name: "vuejs/vue", tag: "v2.7.16" },
  { name: "microsoft/vscode", tag: "1.105.1" },
  { name: "n8n-io/n8n", tag: "n8n@1.117.0" },
  { name: "yangshun/tech-interview-handbook", committish: "95785f2760cd80c14dff3443d65455df0b4ac060" },
  { name: "langgenius/dify", tag: "1.9.2" },
  { name: "excalidraw/excalidraw", tag: "v0.18.0" },
  { "name": "microsoft/TypeScript", "tag": "v5.9.3" },
  { "name": "angular/angular", "tag": "zone.js-0.15.1" },
  { "name": "shadcn-ui/ui", "tag": "shadcn@3.5.0" },
  { "name": "iptv-org/iptv", "committish": "39e180d9aa1087ec4e86544d7bedbaa12824dc3f" },
  { "name": "mui/material-ui", "tag": "v7.3.4" },
  { "name": "ant-design/ant-design", "tag": "resource" },
  { "name": "puppeteer/puppeteer", "tag": "v19.2.2" },
  { "name": "tailwindlabs/tailwindcss", "tag": "v4.1.16" },
  { "name": "supabase/supabase", "tag": "v1.24.09" },
  { "name": "storybookjs/storybook", "tag": "v10.0.0-rc.0" },
  { "name": "ChatGPTNextWeb/NextChat", "tag": "v2.16.1" },
  { "name": "mermaid-js/mermaid", "tag": "v11.0.0" },
  { "name": "gothinkster/realworld", "committish": "32a16a622b0c7138385d6584dfa14269f13d9932" },
  { "name": "immich-app/immich", "tag": "v2.1.0" },
  { "name": "google-gemini/gemini-cli", "tag": "v0.12.0-nightly.20251023.c4c0c0d1" },
  { "name": "clash-verge-rev/clash-verge-rev", "tag": "v2.4.2" },
  { "name": "microsoft/playwright", "tag": "v1.56.1" },
  { "name": "vitejs/vite", "tag": "v7.1.12" },
  { "name": "hoppscotch/hoppscotch", "tag": "v3.0.1" },
  { "name": "coder/code-server", "tag": "v4.105.1" },
  { "name": "nestjs/nest", "tag": "v11.1.7" },
  { "name": "modelcontextprotocol/servers", "tag": "typescript-servers-0.6.2" },
  { "name": "grafana/grafana", "tag": "vtest-new-release-pipeline" },
  { "name": "strapi/strapi", "tag": "v5.29.0" },
  { "name": "apache/superset", "tag": "v2021.41.0" },
  { "name": "lobehub/lobe-chat", "tag": "v1.141.10" },
  { "name": "Eugeny/tabby", "tag": "v1.0.228" },
  { "name": "infiniflow/ragflow", "tag": "v0.21.1" },
  { "name": "apache/echarts", "tag": "v4.2.1-rc1" },
  { "name": "firecrawl/firecrawl", "tag": "v2.4.0" },
  { "name": "socketio/socket.io", "tag": "socket.io@4.8.1" },
  { "name": "facebook/docusaurus", "tag": "v3.9.2" },
  { "name": "reduxjs/redux", "tag": "v5.0.1" },
  { "name": "nuxt/nuxt", "tag": "v4.1.3" },
  { "name": "nocodb/nocodb", "tag": "v2025.09.0" },
  { "name": "toeverything/AFFiNE", "tag": "v2025.10.23-canary.904" },
  { "name": "remix-run/react-router", "tag": "v6.4.0-pre.2" },
  { "name": "pmndrs/zustand", "tag": "v5.0.8" },
  { "name": "withastro/astro", "tag": "v0.0.12" },
  { "name": "appwrite/appwrite", "tag": "working-graphql" },
  { "name": "ionic-team/ionic-framework", "tag": "v8.7.7" },
  { "name": "vuejs/core", "tag": "v3.6.0-alpha.2" },
  { "name": "laurent22/joplin", "tag": "v3.5.5" },
  { "name": "cline/cline", "tag": "v3.34.0" },
  { "name": "DefinitelyTyped/DefinitelyTyped", "committish": "f8f40b1f4cbe22db7aca4e2c7c59a631d264cc4d" },
  { "name": "cypress-io/cypress", "tag": "v15.5.0" },
  { "name": "TanStack/query", "tag": "v5.90.3" },
  { "name": "type-challenges/type-challenges", "committish": "b36c05c9cdf6b42f9540f95a87bb8a7b874d000c" },
  { "name": "lyswhut/lx-music-desktop", "tag": "v2.11.0" },
  { "name": "slab/quill", "tag": "v2.0.3" },
  { "name": "FlowiseAI/Flowise", "tag": "flowise@3.0.8" },
  { "name": "pixijs/pixijs", "tag": "v8.14.0" },
  { "name": "jestjs/jest", "tag": "v30.2.0" },
  { "name": "vercel/hyper", "tag": "v4.0.0-canary.5" },
  { "name": "expo/expo", "committish": "98e4c5d0b70ded4d33c46634047b6f5313fd6616" },
  { "name": "prisma/prisma", "tag": "6.18.0" },
  { "name": "react-hook-form/react-hook-form", "tag": "v8.0.0-alpha.5" },
  { "name": "babel/babel", "tag": "v8.0.0-beta.3" },
  { "name": "RocketChat/Rocket.Chat", "tag": "7.12.0-rc.1" },
  { "name": "streamich/react-use", "tag": "v17.6.0" },
  { "name": "FuelLabs/fuels-ts", "tag": "v0.101.3" },
  { "name": "tldraw/tldraw", "tag": "v4.1.1" },
  { "name": "OpenCut-app/OpenCut", "committish": "bee7aba960c24cd81a3449f2ef58855815c81859" },
  { "name": "AykutSarac/jsoncrack.com", "tag": "v5.0.0-beta.1" },
  { "name": "styled-components/styled-components", "tag": "v6.1.13" },
  { "name": "hexojs/hexo", "tag": "v8.0.0" },
  { "name": "vuetifyjs/vuetify", "tag": "v3.10.7" },
  { "name": "slidevjs/slidev", "tag": "v52.5.0" },
  { "name": "upscayl/upscayl", "tag": "v2.15.1" },
  { "name": "colinhacks/zod", "tag": "v4.1.12" },
  { "name": "anthropics/claude-code", "committish": "3be721535492b619173aaa2e794f771646a2932f" },
  { "name": "chakra-ui/chakra-ui", "tag": "with-typescript@1.0.0-next.4" },
  { "name": "makeplane/plane", "tag": "v1.1.0" },
  { "name": "DIYgod/RSSHub", "committish": "decbabf6658f338015b17d4d7e6545d725e1147f" },
  { "name": "trpc/trpc", "tag": "v11.6.0" },
  { "name": "siyuan-note/siyuan", "tag": "v202205311650-dev" },
  { "name": "fastapi/full-stack-fastapi-template", "committish": "77b524df60b5cee5bb8d96c066c9a84565fe9316" },
  { "name": "calcom/cal.com", "tag": "v5.9.10" },
  { "name": "payloadcms/payload", "tag": "v3.61.0" },
  { "name": "menloresearch/jan", "tag": "v0.7.2" },
  { "name": "appsmithorg/appsmith", "tag": "v1.89" },
  { "name": "novuhq/novu", "tag": "v2.3.0" },
  { "name": "ant-design/ant-design-pro", "tag": "v6.0.0-beta.1" },
  { "name": "Kong/insomnia", "tag": "v9.3.0-alpha.0-experimental" },
  { "name": "chatboxai/chatbox", "tag": "v1.15.4" },
  { "name": "NervJS/taro", "tag": "v4.1.8-beta.2" },
  { "name": "inkonchain/ink-kit", "committish": "767f5a2f03c9055803bb47a3701e046ee1efc131" },
  { "name": "twentyhq/twenty", "tag": "v1.8.2" },
  { "name": "chatchat-space/Langchain-Chatchat", "tag": "v0.3.1" },
  { "name": "date-fns/date-fns", "tag": "v4.1.0" },
  { "name": "lerna/lerna", "tag": "v9.0.0" },
  { "name": "typeorm/typeorm", "tag": "0.3.27" },
  { "name": "outline/outline", "tag": "v1.0.0-test8" },
  { "name": "spacedriveapp/spacedrive", "tag": "0.4.3" },
  { "name": "nativefier/nativefier", "tag": "v52.0.0" },
  { "name": "RSSNext/Folo", "tag": "v0.7.1" },
  { "name": "reworkd/AgentGPT", "committish": "18b073ab05b2902e1d052c3d2799786d8623b5e5" },
  { "name": "portainer/portainer", "tag": "v0.10.1" },
  { "name": "CherryHQ/cherry-studio", "tag": "v1.7.0-sora.3" },
  { "name": "solidjs/solid", "tag": "v2.0.0-experimental.7" },
  { "name": "jaredpalmer/formik", "tag": "v2.1.6-canary.0" },
  { "name": "mattermost/mattermost", "tag": "v11.1.0-rc1" },
  { "name": "mifi/lossless-cut", "tag": "v3.66.1" },
  { "name": "AmruthPillai/Reactive-Resume", "tag": "v4.5.1" },
  { "name": "alan2207/bulletproof-react", "committish": "c66ea0618e65d751972116920aff53338e763447" },
  { "name": "ueberdosis/tiptap", "tag": "v3.7.2" },
  { "name": "immutable-js/immutable-js", "tag": "v5.1.4" },
  { "name": "refinedev/refine", "tag": "with-nextjs@1.0.0" },
  { "name": "xyflow/xyflow", "tag": "v10.0.7" },
  { "name": "directus/directus", "tag": "v11.12.0" },
  { "name": "pnpm/pnpm", "tag": "v10.19.1-oidc-test.3" },
  { "name": "mckaywrigley/chatbot-ui", "committish": "81328b61d2a4ab597a7a057be70e785cf756d9f8" },
  { "name": "vadimdemedes/ink", "tag": "v6.3.1" },
  { "name": "balena-io/etcher", "tag": "v2.1.4" },
  { "name": "TriliumNext/Trilium", "tag": "v0.99.3" },
  { "name": "vercel/swr", "tag": "v2.3.6" },
  { "name": "floating-ui/floating-ui", "tag": "v2.11.8" },
  { "name": "remix-run/remix", "tag": "v2.11.1" },
  { "name": "hasura/graphql-engine", "tag": "v3.alpha.12-19-2023" },
  { "name": "shardeum/shardeum", "tag": "v1.20.0-prerelease.1" },
  { "name": "backstage/backstage", "tag": "v1.44.2" },
  { "name": "niklasvh/html2canvas", "tag": "v1.4.1" },
  { "name": "ZuodaoTech/everyone-can-use-english", "tag": "v0.7.9" },
  { "name": "ReactiveX/rxjs", "tag": "8.0.0-alpha.14" },
  { "name": "umami-software/umami", "tag": "v2.19.0" },
  { "name": "ianstormtaylor/slate", "tag": "v0.61.3" },
  { "name": "codex-team/editor.js", "tag": "v2.31.0-rc.10" },
  { "name": "danny-avila/LibreChat", "tag": "v0.8.0-rc4" },
  { "name": "medusajs/medusa", "tag": "v2.11.0" },
  { "name": "drizzle-team/drizzle-orm", "tag": "v0.32.0-beta" },
  { "name": "fabricjs/fabric.js", "tag": "v700-beta1" },
  { "name": "transloadit/uppy", "tag": "v0.25.6" },
  { "name": "sequelize/sequelize", "tag": "v7.0.0-oc-test.4" },
  { "name": "motiondivision/motion", "tag": "v13.0.0-alpha.0" },
  { "name": "mantinedev/mantine", "tag": "8.3.5" },
  { "name": "cheeriojs/cheerio", "tag": "v1.1.2" },
  { "name": "pmndrs/react-three-fiber", "tag": "v9.4.0" },
  { "name": "refined-github/refined-github", "tag": "25.10.2" },
  { "name": "heyverse/hey", "committish": "29805e69f64e698d8e40dd23ae07639672a424f5" },
  { "name": "continuedev/continue", "tag": "v1.5.6-beta.20251023" },
  { "name": "pmndrs/react-spring", "tag": "vnightly-789adf2" },
  { "name": "sst/opencode", "tag": "vscode-v0.0.12" },
  { "name": "postcss/postcss", "tag": "8.5.6" },
  { "name": "statelyai/xstate", "tag": "xstate@5.23.0" },
  { "name": "pear-devs/pear-desktop", "tag": "v3.11.0" },
  { "name": "GitbookIO/gitbook", "tag": "@gitbook/react-openapi@1.5.2" },
  { "name": "t3-oss/create-t3-app", "tag": "v5.7.0-next" },
  { "name": "mobxjs/mobx", "tag": "v6.11.0-pre" },
  { "name": "tailwindlabs/headlessui", "tag": "v0.0.2" },
  { "name": "JedWatson/react-select", "tag": "v4.3.1" },
  { "name": "nextauthjs/next-auth", "tag": "v4.2.1" },
  { "name": "jitsi/jitsi-meet", "tag": "vtesting1.2.3" },
  { "name": "the1812/Bilibili-Evolved", "tag": "v2.10.4-preview" },
  { "name": "voideditor/void", "committish": "1ee8980fe13978c58ff741d1d667a165fe43c550" },
  { "name": "nrwl/nx", "tag": "v17.0.6" },
  { "name": "TanStack/table", "tag": "v9.0.0-alpha.10" },
  { "name": "Budibase/budibase", "tag": "v2.8.14" },
  { "name": "heroui-inc/heroui", "tag": "vv1.0.0-beta.13" },
  { "name": "angular/angular-cli", "tag": "v12.2.0-next.2" },
  { "name": "ItzCrazyKns/Perplexica", "tag": "v1.11.1" },
  { "name": "honojs/hono", "tag": "vv3.5.0-rc.1" },
  { "name": "Lissy93/web-check", "committish": "9407f5c4b040480d601fe2f4f8a794a1c28742fc" },
  { "name": "element-plus/element-plus", "tag": "v1.0.1-beta.24" },
  { "name": "blakeblackshear/frigate", "tag": "v0.16.2" },
  { "name": "discordjs/discord.js", "tag": "v5.3.1" },
  { "name": "marmelab/react-admin", "tag": "v5.12.1" },
  { "name": "recharts/recharts", "tag": "v3.3.0" },
  { "name": "labring/FastGPT", "tag": "v4.13.2" },
  { "name": "invoke-ai/InvokeAI", "tag": "vinstaller-test-delete" },
  { "name": "Dokploy/dokploy", "tag": "v0.25.5" },
  { "name": "ComposioHQ/composio", "tag": "v0.9.0" },
  { "name": "akveo/ngx-admin", "tag": "v11.0.0" },
  { "name": "oldj/SwitchHosts", "tag": "v4.2.0-beta" },
  { "name": "Molunerfinn/PicGo", "tag": "v2.4.0-beta.10" },
  { "name": "fingerprintjs/fingerprintjs", "tag": "v5.0.1" },
  { "name": "daytonaio/daytona", "tag": "v0.112.0" },
  { "name": "mattermost-community/focalboard", "tag": "v8.0.0" },
  { "name": "NativeScript/NativeScript", "tag": "webpack-5.0.0" },
  { "name": "Redocly/redoc", "tag": "v2.5.1" },
  { "name": "withfig/autocomplete", "tag": "v6" },
  { "name": "GrapesJS/grapesjs", "tag": "v0.22.13" },
  { "name": "neoclide/coc.nvim", "tag": "v0.0.82" },
  { "name": "homebridge/homebridge", "tag": "v1.11.0" },
  { "name": "angular/components", "tag": "21.0.0-next.10" },
  { "name": "kamranahmedse/driver.js", "tag": "v1.1.11-next.0" },
  { "name": "vuejs/devtools-v6", "tag": "v6.6.4" },
  { "name": "sst/sst", "tag": "v3.17.21" },
  { "name": "BabylonJS/Babylon.js", "tag": "v4.0.0" },
  { "name": "nextai-translator/nextai-translator", "tag": "v0.5.1" },
  { "name": "CopilotKit/CopilotKit", "tag": "vundefined" },
  { "name": "OI-wiki/OI-wiki", "committish": "d84bb98a44712d1519bac5f1b26692d780abb6b2" },
  { "name": "responsively-org/responsively-app", "tag": "v1.17.1" },
  { "name": "remotion-dev/remotion", "tag": "v4.1.0-alpha2" },
  { "name": "react-navigation/react-navigation", "tag": "v4.1.1" },
  { "name": "electron-react-boilerplate/electron-react-boilerplate", "tag": "v4.6.0" },
  { "name": "youzan/vant", "tag": "v4.9.21" },
  { "name": "SigNoz/signoz", "tag": "v0.98.0-rc.1" },
  { "name": "gitroomhq/postiz-app", "tag": "v2.8.0" },
  { "name": "GoogleChromeLabs/squoosh", "tag": "v1.12.0" },
  { "name": "doczjs/docz", "tag": "v2.4.0" },
  { "name": "usablica/intro.js", "tag": "v8.3.2" },
  { "name": "rahuldkjain/github-profile-readme-generator", "committish": "26db3b7d8c0ddbe0f5e3661b095ae63c0ca9e442" },
  { "name": "jquense/yup", "tag": "v1.7.0" },
  { "name": "reduxjs/react-redux", "tag": "v9.2.0" },
  { "name": "hcengineering/platform", "tag": "v0.7.266", "skip": "no package.json" },
  { "name": "kriasoft/react-starter-kit", "committish": "1d07402ad5f744c3cac0cd6d5de20bf1efaade5b" },
  { "name": "conwnet/github1s", "tag": "v0.31.0" },
  { "name": "wg-easy/wg-easy", "committish": "013ea6dba928ab3d25b5d1de2bca4d0d61d692cf" },
  { "name": "Infisical/infisical", "tag": "v0.153.0-nightly-20251024" },
  { "name": "felixrieseberg/windows95", "committish": "a6d57c6538da2b331aa81c6af35163b804aaa2f6" },
  { "name": "onlook-dev/onlook", "tag": "v0.2.33" },
  { "name": "actualbudget/actual", "tag": "v25.10.0" },
  { "name": "pubkey/rxdb", "tag": "16.20.0" },
  { "name": "react-bootstrap/react-bootstrap", "tag": "v3.0.0-beta.5" },
  { "name": "dubinc/dub", "committish": "2e276cb801e886410ac447534599568c4a59f0e9" },
  { "name": "t4t5/sweetalert", "tag": "v2.1.1" },
  { "name": "facebook/lexical", "tag": "v0.37.1-nightly.20251023.0" },
  { "name": "microsoft/playwright-mcp", "tag": "v0.0.43" },
  { "name": "jhipster/generator-jhipster", "tag": "v8.11.0" },
  { "name": "better-auth/better-auth", "tag": "v1.4.0-beta.13" },
  { "name": "wechaty/wechaty", "tag": "v0.56" },
  { "name": "BuilderIO/gpt-crawler", "committish": "d2245d66a5ad60bf227a55c849135394cbecc9b5" },
  { "name": "zzzgydi/clash-verge", "tag": "v1.3.8" },
  { "name": "wandb/openui", "committish": "f9d8f0e30e1efe2a21bbefffba33bcf6b4e12dc7", "skip": "no package.json" },
  { "name": "QwikDev/qwik", "tag": "v1.7.1" },
  { "name": "vueuse/vueuse", "tag": "v14.0.0-beta.1" },
  { "name": "react-dnd/react-dnd", "tag": "vundefined" },
  { "name": "basarat/typescript-book", "committish": "e31fe92c3afeea1bbcac4381d290e75e5b3ab6e3" },
  { "name": "palantir/blueprint", "tag": "test-react15@1.1.2" },
  { "name": "darkreader/darkreader", "tag": "v4.9.112" },
  { "name": "firecrawl/open-lovable", "committish": "ce3e23c921cc37282df37b50bf7c87d4e7cda064" },
  { "name": "SBoudrias/Inquirer.js", "tag": "v6.0.0" },
  { "name": "nikivdev/myflow", "committish": "16420f4f8c35336300c933aa871e9d325c01d73a" },
  { "name": "eclipse-theia/theia", "tag": "v1.65.2" },
  { "name": "maotoumao/MusicFree", "tag": "v0.6.2" },
  { "name": "beekeeper-studio/beekeeper-studio", "tag": "v5.4.9" },
  { "name": "desktop/desktop", "tag": "release-3.5.4-test1" },
  { "name": "elastic/kibana", "tag": "v9.2.0" },
  { "name": "pmndrs/jotai", "tag": "v2.15.0" },
  { "name": "RealKai42/qwerty-learner", "committish": "80cf73647adbf55a9e5ee6e5662c2b0359182235" },
  { "name": "karakeep-app/karakeep", "tag": "v0.27.1" },
  { "name": "lit/lit", "tag": "v1.3.0" },
  { "name": "GeekyAnts/NativeBase", "tag": "v3.5.0-rc.4" },
  { "name": "airbnb/visx", "tag": "v3.13.2-alpha.0" },
  { "name": "a2aproject/A2A", "committish": "e7cf203ecdd7003c0f1740bb712248d2b5252bf1" },
  { "name": "graphql/graphql-js", "tag": "v17.0.0-alpha.9" },
  { "name": "apify/crawlee", "tag": "v3.15.2" },
  { "name": "bokeh/bokeh", "tag": "branch-3.2-final-commit", "skip": "no package.json" },
  { "name": "wenyan-lang/wenyan", "committish": "97f0a4b8c5a815467c5c2cac08215d722efde208" },
  { "name": "teableio/teable", "committish": "e4ffd72b5f06e52a63532332a0b8a67daf606fb5" },
  { "name": "musistudio/claude-code-router", "committish": "1a4462a92362e8c41d4539dc1a79fb85fccf9559" },
  { "name": "fullcalendar/fullcalendar", "tag": "v6.1.19" },
  { "name": "louislam/dockge", "committish": "e31f76651684cf3252471ee48051088175951cfe" },
  { "name": "renovatebot/renovate", "tag": "v11.35.4" },
  { "name": "web3/web3.js", "tag": "web3-utils@4.0.0-alpha.0" },
  { "name": "Lissy93/personal-security-checklist", "committish": "7314b770c0402de5cf9448e78112fed6935d730a" },
  { "name": "yamadashy/repomix", "tag": "v1.8.0" },
  { "name": "apollographql/apollo-client", "tag": "v4.0.0-alpha.15" },
  { "name": "microsoft/fluentui", "tag": "v6.0.0-beta1" },
  { "name": "pavlobu/deskreen", "committish": "db467c5dcc35995777075192183531e7f244b50d" },
  { "name": "aidenybai/react-scan", "tag": "v0.4.3" },
  { "name": "lucide-icons/lucide", "tag": "v0.265.0" },
  { "name": "chartdb/chartdb", "tag": "v1.16.0" },
  { "name": "bytedance/UI-TARS-desktop", "tag": "v0.3.0-beta.12-canary-db0aade42-20250926094924" },
  { "name": "xtermjs/xterm.js", "tag": "5.5.0" },
  { "name": "infinitered/ignite", "tag": "v11.3.2" },
  { "name": "railsware/upterm", "tag": "v0.4.4" },
  { "name": "reduxjs/reselect", "tag": "v5.1.1" },
  { "name": "shadcn-ui/taxonomy", "committish": "651f984e52edd65d40ccd55e299c1baeea3ff017" },
  { "name": "tensorflow/tfjs", "tag": "v1.2.9" },
  { "name": "eggjs/egg", "tag": "v4.1.0-beta.30" },
  { "name": "wulkano/Kap", "tag": "v3.6.0" },
  { "name": "subquery/subql", "tag": "validator/2.2.0" },
  { "name": "activepieces/activepieces", "tag": "0.70.8" },
  { "name": "vercel/ai", "tag": "vundefined" },
  { "name": "rrweb-io/rrweb", "tag": "rrweb@2.0.0-alpha.18" },
  { "name": "monkeytypegame/monkeytype", "tag": "v25.36.0" },
  { "name": "browserbase/stagehand", "tag": "@browserbasehq/stagehand@2.5.2" },
  { "name": "baidu/amis", "tag": "v6.13.0-beta.8" },
  { "name": "alibaba/ice", "tag": "v3.6.2" },
  { "name": "whyour/qinglong", "tag": "v2.19.2" },
  { "name": "vercel/ai-chatbot", "tag": "v3.1.0" },
  { "name": "kortix-ai/suna", "committish": "7c9a8877c1d0dba74bc164a94fd10186d37a38ff" },
  { "name": "winfunc/opcode", "committish": "70c16d8a4910db48cd9684aeacdd431caefd7d71" },
  { "name": "adonisjs/core", "tag": "vv5.0.0-preview-rc-1.4" },
  { "name": "teambit/bit", "tag": "v14.8.9-server.1" },
  { "name": "unocss/unocss", "tag": "v66.5.4" },
  { "name": "wangeditor-team/wangEditor", "tag": "v1668392446593" },
  { "name": "compiler-explorer/compiler-explorer", "tag": "gh-16590" },
  { "name": "coze-dev/coze-studio", "committish": "a26f7d58aac9951163c6064e2d70487b56c68608" },
  { "name": "github/docs", "committish": "f91b3518f827b045194320ac9e3c4e2ae757c1ce" },
  { "name": "conventional-changelog/commitlint", "tag": "v20.1.0" },
  { "name": "radix-ui/primitives", "committish": "36d954d3c1b41c96b1d2e875b93fc9362c8c09e6" },
  { "name": "transitive-bullshit/agentic", "tag": "v8.4.4" },
  { "name": "dzhng/deep-research", "committish": "775e2729bad1dc3bd628db40776312a4d9229bdc" },
  { "name": "ionic-team/ionicons", "tag": "v8.0.13" },
  { "name": "birobirobiro/awesome-shadcn-ui", "committish": "6cd753a8f19d903522cdf400d24036d0b827b187" },
  { "name": "ether/etherpad-lite", "tag": "v2.5.1" },
  { "name": "tusen-ai/naive-ui", "tag": "v2.43.1" },
  { "name": "oblador/react-native-vector-icons", "tag": "v10.2.0" },
  { "name": "reduxjs/redux-thunk", "tag": "v3.1.0" },
  { "name": "nhn/tui.editor", "tag": "vue-editor@3.0.1" },
  { "name": "mastra-ai/mastra", "tag": "v0.1.10" },
  { "name": "catppuccin/catppuccin", "committish": "865691f4f07860ce9a87d5eaf183d9c838257537" },
  { "name": "motion-canvas/motion-canvas", "tag": "v3.18.0-alpha.0" },
  { "name": "redwoodjs/graphql", "tag": "v8.9.0" },
  { "name": "docmost/docmost", "tag": "v0.23.2" },
  { "name": "justadudewhohacks/face-api.js", "tag": "0.22.2" },
  { "name": "CopyTranslator/CopyTranslator", "tag": "v11.0.2" },
  { "name": "langfuse/langfuse", "tag": "v3.121.0" },
  { "name": "redis/node-redis", "tag": "v4.0.0-rc.3" },
  { "name": "aidenybai/million", "tag": "v3.1.7" },
  { "name": "mihomo-party-org/clash-party", "tag": "v1.8.8" },
  { "name": "Tencent/vConsole", "tag": "v3.15.1" },
  { "name": "verdaccio/verdaccio", "tag": "verdaccio@6.0.0-6-next.40" },
  { "name": "mswjs/msw", "tag": "v2.11.6" },
  { "name": "simstudioai/sim", "tag": "v1.0.0" },
  { "name": "material-components/material-components-web", "tag": "v14.0.0" },
  { "name": "bluesky-social/social-app", "tag": "1.109.0" },
  { "name": "elizaOS/eliza", "tag": "v1.6.4-alpha.2" },
  { "name": "nocobase/nocobase", "tag": "v2.0.0-alpha.20" },
  { "name": "dyad-sh/dyad", "tag": "v0.26.0-beta.1" },
  { "name": "resend/react-email", "tag": "v0.0.15-canary.0" },
  { "name": "bvaughn/react-window", "tag": "delete" },
  { "name": "learn-anything/learn-anything", "committish": "7e2123d42e8795214d74c09cdbec5ae7ec05f158" },
  { "name": "leon-ai/leon", "tag": "v1.0.0-beta.8" },
  { "name": "mlc-ai/web-llm", "committish": "e4b4dc2952afb61f048e4422459b038a88684fd7" },
  { "name": "graphql/graphiql", "tag": "vscode-graphql-syntax@1.0.2" },
  { "name": "carloscuesta/gitmoji", "tag": "v3.15.0" },
  { "name": "ustbhuangyi/better-scroll", "tag": "v2.5.1" },
  { "name": "foambubble/foam", "tag": "v0.28.3" },
  { "name": "labring/sealos", "tag": "v5.1.0-rc3" },
  { "name": "tremorlabs/tremor-npm", "tag": "v4.0.0-beta-tremor-v4.4" },
  { "name": "umijs/qiankun", "tag": "v3.0.0-rc.3" },
  { "name": "flatpickr/flatpickr", "tag": "v4.6.13" },
  { "name": "sindresorhus/type-fest", "tag": "v5.1.0" },
  { "name": "vuejs/vitepress", "tag": "v2.0.0-alpha.12" },
  { "name": "linshenkx/prompt-optimizer", "committish": "2a0151ab812d808320d8154ec8e6079d4382cde2" },
  { "name": "richards199999/Thinking-Claude", "committish": "fc4805f37f9af519774a72bde0541803b42fb9d6" },
  { "name": "nukeop/nuclear", "tag": "v0.6.48" },
  { "name": "video-dev/hls.js", "tag": "v1.7.0-alpha.0" },
  { "name": "diegomura/react-pdf", "tag": "v2.0.0-beta.6" },
  { "name": "langchain-ai/langchainjs", "tag": "v1-head" },
  { "name": "mayooear/ai-pdf-chatbot-langchain", "committish": "4bb98092472d0af57db600a10ba2183d76adecc4" },
  { "name": "sismo-core/sismo-badges", "tag": "v1.0.3-alpha" },
  { "name": "typescript-eslint/typescript-eslint", "tag": "v8.46.2" },
  { "name": "amplication/amplication", "tag": "v3.14.0" },
  { "name": "clauderic/dnd-kit", "tag": "@dnd-kit/utilities@3.2.2" },
  { "name": "tinymce/tinymce", "tag": "tinymce@6.8.4" },
  { "name": "umijs/umi", "tag": "v4.5.3" },
  { "name": "stackblitz/bolt.new", "committish": "eda10b121221b30825a4c16eec5da1fd3eb1eb99" },
  { "name": "mediar-ai/screenpipe", "tag": "v0.2.74" },
  { "name": "react-native-maps/react-native-maps", "tag": "v2.0.0-beta.15" },
  { "name": "sindresorhus/ky", "tag": "v1.13.0" },
  { "name": "alibaba/lowcode-engine", "tag": "v2.0.0-beta.8" },
  { "name": "humanlayer/12-factor-agents", "committish": "d20c728368bf9c189d6d7aab704744decb6ec0cc" },
  { "name": "signalapp/Signal-Desktop", "tag": "v7.77.0-beta.1" },
  { "name": "johannesjo/super-productivity", "tag": "v16.0.0" },
  { "name": "fosrl/pangolin", "tag": "1.11.1-s.0" },
  { "name": "omnivore-app/omnivore", "tag": "v1.4.2-10" },
  { "name": "steven-tey/novel", "tag": "v0.2.0" },
  { "name": "javascript-obfuscator/javascript-obfuscator", "tag": "4.1.1" },
  { "name": "infinitered/reactotron", "tag": "v3.3.8" },
  { "name": "rjsf-team/react-jsonschema-form", "tag": "v6.0.0-beta.22" },
  { "name": "sass/sass", "tag": "proposal.supports-general.draft-2.1" },
  { "name": "udecode/plate", "tag": "v1.0.0-next.48" },
  { "name": "linkwarden/linkwarden", "tag": "v2.13.1" },
  { "name": "kubeflow/kubeflow", "tag": "v1.10.0-rc.2" },
  { "name": "feathersjs/feathers", "tag": "v6.0.0-pre.3" },
  { "name": "vitest-dev/vitest", "tag": "v4.0.2" },
  { "name": "uuidjs/uuid", "tag": "v13.0.0" },
  { "name": "redis/ioredis", "tag": "v5.8.2" },
  { "name": "apitable/apitable", "tag": "v1.13.0-beta.1" },
  { "name": "airbnb/react-sketchapp", "tag": "v3.2.2" },
  { "name": "VSCodeVim/Vim", "tag": "v1.31.0" },
  { "name": "jupyterlab/jupyterlab", "tag": "v4.5.0b1" },
  { "name": "BrainJS/brain.js", "tag": "1.4.10" },
  { "name": "sindresorhus/got", "tag": "v14.6.0" },
  { "name": "alibaba/hooks", "tag": "v3.9.5" },
  { "name": "nextjs/saas-starter", "committish": "e0dc5d40ce26c01672557912b533d25e32957ad4" },
  { "name": "tensorflow/tfjs-models", "tag": "universal-sentence-encoder-v1.3.3" },
  { "name": "QwenLM/qwen-code", "tag": "v0.1.0-preview" },
  { "name": "cyrildiagne/ar-cutpaste", "committish": "155fddc9b16d5e6ab4f67864c87875d832626feb" },
  { "name": "ag-grid/ag-grid", "tag": "vDocs-29.1.0-20230221" },
  { "name": "formatjs/formatjs", "tag": "website@1.0.2" },
  { "name": "ahmedkhaleel2004/gitdiagram", "committish": "ca88e20e1707577830a99a3177bdee4553aaaae8" },
  { "name": "caprover/caprover", "tag": "v1.14.0" },
  { "name": "faker-js/faker", "tag": "v10.1.0" },
  { "name": "jimp-dev/jimp", "tag": "v1.6.0" },
  { "name": "hydralauncher/hydra", "tag": "v3.7.1" },
  { "name": "adobe/react-spectrum", "tag": "v2.27.0" },
  { "name": "Tonejs/Tone.js", "committish": "797dae48830af44d32b20470e7a6e38e4b4609a5" },
  { "name": "ajv-validator/ajv", "tag": "v8.17.1" },
  { "name": "elysiajs/elysia", "tag": "v0.5.1" },
  { "name": "lyswhut/lx-music-mobile", "tag": "v1.7.1" },
  { "name": "gvergnaud/ts-pattern", "tag": "v5.8.0" },
  { "name": "google/brotli", "tag": "v1.2.0rc2" },
  { "name": "electron-userland/electron-builder", "tag": "v29.30.0" },
  { "name": "reduxjs/redux-devtools", "tag": "v3.6.0" },
  { "name": "botpress/botpress", "tag": "v12.30.9" },
  { "name": "vuejs/pinia", "tag": "v3.0.3" },
  { "name": "vercel/vercel", "tag": "vercel@48.6.0" },
  { "name": "readest/readest", "tag": "v0.9.88" },
  { "name": "ionic-team/capacitor", "tag": "v0.0.46" },
  { "name": "Chocobozzz/PeerTube", "tag": "v7.3.0-rc.1" },
  { "name": "FaridSafi/react-native-gifted-chat", "tag": "v2.4.1" },
  { "name": "Koenkk/zigbee2mqtt", "tag": "2.6.2" },
  { "name": "blitz-js/blitz", "tag": "v3.0.2" },
  { "name": "callstack/react-native-paper", "tag": "v5.14.5" },
  { "name": "ConsenSys-archive/truffle", "tag": "v5.11.5" },
  { "name": "yoavbls/pretty-ts-errors", "committish": "512f102bba741a575e986d261bc830a45f017316" },
  { "name": "Sairyss/domain-driven-hexagon", "committish": "5c2d15a7e2d69e83dfddf28468ee9f30e02c30de" },
  { "name": "danilowoz/react-content-loader", "tag": "v7.1.1" },
  { "name": "microsoft/data-formulator", "committish": "bb47180c795a9e6034eb265d9891a39c7855b9df" },
  { "name": "apollographql/apollo-server", "tag": "vundefined" },
  { "name": "plouc/nivo", "tag": "v0.99.0" },
  { "name": "getmaxun/maxun", "tag": "v0.0.25" },
  { "name": "shoelace-style/shoelace", "tag": "v2.20.1" },
  { "name": "fengyuanchen/cropperjs", "tag": "v2.1.0" },
  { "name": "dexie/Dexie.js", "tag": "v4.2.1" },
  { "name": "konvajs/konva", "tag": "10.0.7" },
  { "name": "formkit/auto-animate", "tag": "v0.9.0" },
  { "name": "vercel/commerce", "committish": "fa1306916c652ea5f820d5b400087bece13460fd" },
  { "name": "SawyerHood/draw-a-ui", "committish": "1aca63b4d54a3065fe72fe9784c91265510fbe19" },
  { "name": "QwikDev/partytown", "tag": "v0.11.2" },
  { "name": "visgl/deck.gl", "tag": "v9.2.2" },
  { "name": "CapSoftware/Cap", "tag": "cap-v0.3.77" },
  { "name": "gitpod-io/gitpod", "tag": "v0.10.0-test1" },
  { "name": "denoland/fresh", "tag": "2.1.3" },
  { "name": "nexe/nexe", "tag": "v4.0.0-beta.19" },
  { "name": "angular-ui/ui-router", "tag": "SNAPSHOT-20170629" },
  { "name": "BuilderIO/mitosis", "tag": "@jsx-lite/cli@1.0.1" },
  { "name": "facebook/flipper", "tag": "v0.273.0" },
  { "name": "ikatyang/emoji-cheat-sheet", "committish": "d4ccec71e64d090a936d83cea31af45c7e851d8f" },
  { "name": "ourongxing/newsnow", "tag": "v0.0.35" },
  { "name": "chartist-js/chartist", "tag": "v1.5.0" },
  { "name": "glideapps/quicktype", "committish": "41950205609abd8c18a8e315ea87d8904f625012" },
  { "name": "fkhadra/react-toastify", "tag": "v11.0.5" },
  { "name": "piotrwitek/react-redux-typescript-guide", "committish": "47ca335db14a8bbc30f99d2474446b38f945cb24" },
  { "name": "TibixDev/winboat", "tag": "v0.8.7" },
  { "name": "fuergaosi233/wechat-chatgpt", "committish": "e96349ffa2173b20135809601eb7ee7b996a3111" },
  { "name": "soybeanjs/soybean-admin", "tag": "v1.3.15" },
  { "name": "shuding/nextra", "tag": "v2.0.0-beta.5" },
  { "name": "schickling/chromeless", "committish": "774223e4e7f6e28242c8925d348cd6d543df0bf5" },
  { "name": "tamagui/tamagui", "tag": "v1.135.4" },
  { "name": "Tencent/omi", "tag": "v7.7.0" },
  { "name": "mountain-loop/yaak", "tag": "v2025.7.2" },
  { "name": "wong2/chatgpt-google-extension", "tag": "v1.17.0" },
  { "name": "google/blockly", "tag": "blockly-v12.3.1" },
  { "name": "TypeStrong/ts-node", "tag": "v11.0.0-beta.1" },
  { "name": "electric-sql/pglite", "tag": "v0.2.0-alpha.9" },
  { "name": "peers/peerjs", "tag": "v1.5.5" },
  { "name": "rt2zz/redux-persist", "tag": "v6.0.0-pre2.1" },
  { "name": "hotwired/stimulus", "tag": "v3.2.2" },
  { "name": "streetwriters/notesnook", "tag": "v3.3.2" },
  { "name": "stenciljs/core", "tag": "v4.38.2" },
  { "name": "MetaMask/metamask-extension", "tag": "v13.5.0-flask.0" },
  { "name": "kysely-org/kysely", "tag": "v0.28.8" },
  { "name": "crimx/ext-saladict", "tag": "zh" },
  { "name": "tinacms/tinacms", "tag": "v0.43.3" },
  { "name": "graphile/crystal", "tag": "vundefined" },
  { "name": "supermemoryai/supermemory", "committish": "155ec718e202058dffaab4f2e709e9b1c0eb74eb" },
  { "name": "taye/interact.js", "tag": "v1.10.27" },
  { "name": "Unleash/unleash", "tag": "v7.2.3" },
  { "name": "barbajs/barba", "tag": "v2.10.3" },
  { "name": "tradingview/lightweight-charts", "tag": "v5.0.9" },
  { "name": "midday-ai/midday", "committish": "ffd7791ef6d158006e96e5306b23fe7bb127048e" },
  { "name": "majodev/google-webfonts-helper", "committish": "6043c3c2690856e3f436657397a2d45163263ab6" },
  { "name": "wasp-lang/open-saas", "committish": "02d0c90eb1750c155ccef3a215e48de58f95a2bc" },
  { "name": "turbolinks/turbolinks", "committish": "80cd172ed5b3a35eda85c58e428de9f1f1d06fc8" },
  { "name": "triggerdotdev/trigger.dev", "tag": "v2.1.0" },
  { "name": "tensorflow/playground", "committish": "02469bd3751764b20486015d4202b792af5362a6" },
  { "name": "Automattic/wp-calypso", "tag": "wpcom-proxy-request@7.0.5" },
  { "name": "vercel/satori", "tag": "0.18.3" },
  { "name": "aws/aws-cdk", "tag": "v2.220.0" },
  { "name": "PlasmoHQ/plasmo", "tag": "v0.90.5" },
  { "name": "nhn/tui.calendar", "tag": "vue-calendar@2.1.3" },
  { "name": "antvis/G2", "tag": "v5.2.12" },
  { "name": "stan-smith/FossFLOW", "committish": "ab8e1b84151480809d78149e3cefec8092454585" },
  { "name": "noodle-run/noodle", "committish": "4e26fb7c990ccccce203f1c30f79126ef1bfbcaa" },
  { "name": "GoogleChromeLabs/comlink", "tag": "v4.4.2" },
  { "name": "ChromeDevTools/chrome-devtools-mcp", "tag": "chrome-devtools-mcp-v0.9.0" },
  { "name": "react-icons/react-icons", "tag": "v5.5.0" },
  { "name": "highcharts/highcharts", "tag": "v12.4.0" },
  { "name": "shikijs/shiki", "tag": "v3.13.0" },
  { "name": "Canner/WrenAI", "tag": "test-rc" },
  { "name": "snabbdom/snabbdom", "tag": "v3.6.3" },
  { "name": "illacloud/illa-builder", "tag": "release/2.9.4" },
  { "name": "alibaba/formily", "tag": "v2.3.7" },
  { "name": "element-hq/element-web", "tag": "v1.12.2-rc.0" },
  { "name": "callstack/linaria", "tag": "v4.0.0" },
];

describe("bun install works on popular packages", () => {
  describe.concurrent.each(PACKAGES_TO_TEST)("$name", async ({ name, tag, committish, skip }) => {
    test.skipIf(skip !== undefined)(
      "perform",
      async () => {
        using workdir = tempDir("popular-packages-install", {});
        const url = `https://github.com/${name}.git`;

        const runAndWait = async (args: string[]) => {
          const proc = Bun.spawn(args, { cwd: workdir, stderr: "pipe", stdout: "pipe" });
          await proc.exited;
          return { code: proc.exitCode, stdout: await proc.stdout.text(), stderr: await proc.stderr.text() };
        };

        const expectRun = async (args: string[]) => {
          const res = await runAndWait(args);
          try {
            expect(res.code).toBe(0);
          } catch (e) {
            console.error(`Command "${args.join(" ")}" failed with stdout:`, res.stdout);
            console.error(`Command "${args.join(" ")}" failed with stderr:`, res.stderr);
            throw e;
          }
        };

        const cloneRepo = async () => {
          if (tag) {
            expect(
              (
                await runAndWait([
                  "git",
                  "clone",
                  "--depth",
                  "1",
                  "--branch",
                  tag,
                  url,
                  ".",
                  "--recurse-submodules",
                  "--shallow-submodules",
                ])
              ).code,
            ).toBe(0);
            return;
          }

          if (committish) {
            await expectRun(["git", "clone", "--depth", "1", url, ".", "--recurse-submodules", "--shallow-submodules"]);
            await expectRun(["git", "fetch", "--depth", "1", "origin", committish]);
            await expectRun(["git", "checkout", committish]);
            return;
          }

          throw new Error("Either tag or committish must be provided");
        };

        await cloneRepo();
        await expectRun([bunExe(), "install", "--no-frozen-lockfile"]);
      },
      MAX_TIMEOUT_MS,
    );
  });
});
