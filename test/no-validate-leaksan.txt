# List of tests for which we do NOT enable LeakSanitizer when running in ASAN CI

test/cli/install/bun-security-scanner-matrix-with-node-modules.test.ts
test/cli/install/bun-security-scanner-matrix-without-node-modules.test.ts

test/js/node/test/parallel/test-worker-abort-on-uncaught-exception.js
test/js/node/test/parallel/test-worker-arraybuffer-zerofill.js
test/js/node/test/parallel/test-worker-cjs-workerdata.js
test/js/node/test/parallel/test-worker-cleanexit-with-js.js
test/js/node/test/parallel/test-worker-cleanexit-with-moduleload.js
test/js/node/test/parallel/test-worker-console-listeners.js
test/js/node/test/parallel/test-worker-dns-terminate-during-query.js
test/js/node/test/parallel/test-worker-environmentdata.js
test/js/node/test/parallel/test-worker-esm-exit.js
test/js/node/test/parallel/test-worker-esm-missing-main.js
test/js/node/test/parallel/test-worker-esmodule.js
test/js/node/test/parallel/test-worker-event.js
test/js/node/test/parallel/test-worker-exit-event-error.js
test/js/node/test/parallel/test-worker-exit-from-uncaught-exception.js
test/js/node/test/parallel/test-worker-exit-heapsnapshot.js
test/js/node/test/parallel/test-worker-fs-stat-watcher.js
test/js/node/test/parallel/test-worker-heap-snapshot.js
test/js/node/test/parallel/test-worker-http2-generic-streams-terminate.js
test/js/node/test/parallel/test-worker-invalid-workerdata.js
test/js/node/test/parallel/test-worker-load-file-with-extension-other-than-js.js
test/js/node/test/parallel/test-worker-memory.js
test/js/node/test/parallel/test-worker-message-channel-sharedarraybuffer.js
test/js/node/test/parallel/test-worker-message-event.js
test/js/node/test/parallel/test-worker-message-port-constructor.js
test/js/node/test/parallel/test-worker-message-port-infinite-message-loop.js
test/js/node/test/parallel/test-worker-message-port-receive-message.js
test/js/node/test/parallel/test-worker-message-port-terminate-transfer-list.js
test/js/node/test/parallel/test-worker-message-port-transfer-duplicate.js
test/js/node/test/parallel/test-worker-message-port-transfer-terminate.js
test/js/node/test/parallel/test-worker-message-port-wasm-module.js
test/js/node/test/parallel/test-worker-message-port-wasm-threads.js
test/js/node/test/parallel/test-worker-mjs-workerdata.js
test/js/node/test/parallel/test-worker-nested-on-process-exit.js
test/js/node/test/parallel/test-worker-nested-uncaught.js
test/js/node/test/parallel/test-worker-no-sab.js
test/js/node/test/parallel/test-worker-non-fatal-uncaught-exception.js
test/js/node/test/parallel/test-worker-on-process-exit.js
test/js/node/test/parallel/test-worker-onmessage-not-a-function.js
test/js/node/test/parallel/test-worker-onmessage.js
test/js/node/test/parallel/test-worker-parent-port-ref.js
test/js/node/test/parallel/test-worker-process-argv.js
test/js/node/test/parallel/test-worker-ref-onexit.js
test/js/node/test/parallel/test-worker-ref.js
test/js/node/test/parallel/test-worker-relative-path-double-dot.js
test/js/node/test/parallel/test-worker-relative-path.js
test/js/node/test/parallel/test-worker-safe-getters.js
test/js/node/test/parallel/test-worker-sharedarraybuffer-from-worker-thread.js
test/js/node/test/parallel/test-worker-terminate-http2-respond-with-file.js
test/js/node/test/parallel/test-worker-terminate-nested.js
test/js/node/test/parallel/test-worker-terminate-null-handler.js
test/js/node/test/parallel/test-worker-terminate-timers.js
test/js/node/test/parallel/test-worker-type-check.js
test/js/node/test/parallel/test-worker-uncaught-exception-async.js
test/js/node/test/parallel/test-worker-unref-from-message-during-exit.js
test/js/node/test/parallel/test-worker-workerdata-sharedarraybuffer.js
test/js/node/test/parallel/test-worker.js
test/js/node/test/parallel/test-worker.mjs
test/js/node/worker_threads/worker_destruction.test.ts
test/js/web/broadcastchannel/broadcast-channel.test.ts


# error exit root cause unclear
test/js/node/test/parallel/test-util-callbackify.js
test/js/node/test/sequential/test-child-process-execsync.js
test/js/node/test/parallel/test-child-process-exec-maxbuf.js
test/js/node/test/parallel/test-fs-readfile-eof.js
test/js/node/test/parallel/test-child-process-promisified.js
test/js/node/test/parallel/test-child-process-exec-encoding.js
test/js/node/test/parallel/test-child-process-execfile.js
test/bundler/bundler_compile.test.ts
test/bundler/bundler_plugin.test.ts
test/bundler/transpiler/bun-pragma.test.ts
test/bundler/transpiler/runtime-transpiler.test.ts
test/cli/hot/hot.test.ts
test/cli/install/bun-add.test.ts
test/cli/install/bun-create.test.ts
test/cli/install/bun-install-lifecycle-scripts.test.ts
test/cli/install/bun-install-patch.test.ts
test/cli/install/bun-install-proxy.test.ts
test/cli/install/bun-install-registry.test.ts
test/cli/install/bun-install-retry.test.ts
test/cli/install/bun-install.test.ts
test/cli/install/bun-lock.test.ts
test/cli/install/bun-lockb.test.ts
test/cli/install/bun-patch.test.ts
test/cli/install/bun-pm.test.ts
test/cli/install/bun-repl.test.ts
test/cli/install/bun-update.test.ts
test/cli/install/bun-workspaces.test.ts
test/cli/install/bunx.test.ts
test/cli/install/isolated-install.test.ts
test/cli/install/migration/complex-workspace.test.ts
test/cli/install/npmrc.test.ts
test/cli/install/overrides.test.ts
test/cli/install/test-dev-peer-dependency-priority.test.ts
test/cli/run/commonjs-invalid.test.ts
test/cli/run/preload-test.test.js
test/cli/run/require-cache.test.ts
test/cli/update_interactive_formatting.test.ts
test/integration/esbuild/esbuild.test.ts
test/integration/expo-app/expo.test.ts
test/integration/next-pages/test/dev-server-ssr-100.test.ts
test/integration/next-pages/test/dev-server.test.ts
test/integration/next-pages/test/next-build.test.ts
test/integration/vite-build/vite-build.test.ts
test/js/bun/css/css-fuzz.test.ts
test/js/bun/ffi/cc.test.ts
test/js/bun/http/bun-serve-html-manifest.test.ts
test/js/bun/http/bun-server.test.ts
test/js/bun/import-attributes/import-attributes.test.ts
test/js/bun/resolve/import-custom-condition.test.ts
test/js/bun/s3/s3.leak.test.ts
test/js/bun/shell/bunshell.test.ts
test/js/bun/shell/commands/ls.test.ts
test/js/bun/shell/leak.test.ts
test/js/bun/shell/lex.test.ts
test/js/bun/spawn/spawn-stdin-destroy.test.ts
test/js/bun/test/snapshot-tests/snapshots/snapshot.test.ts
test/js/bun/test/test-only.test.ts
test/js/node/http/node-http-maxHeaderSize.test.ts
test/js/node/http/node-http.test.ts
test/js/node/http2/node-http2.test.js
test/js/node/no-addons.test.ts
test/js/node/readline/readline_never_unrefs.test.ts
test/js/third_party/@napi-rs/canvas/napi-rs-canvas.test.ts
test/js/third_party/next-auth/next-auth.test.ts
test/js/third_party/pnpm/pnpm.test.ts
test/js/web/console/console-log.test.ts
test/js/web/fetch/fetch-leak.test.ts
test/js/web/fetch/fetch.tls.test.ts
test/regression/issue/09559.test.ts
test/regression/issue/14477/14477.test.ts
test/js/node/process/stdin/stdin-fixtures.test.ts
test/cli/install/bun-run.test.ts
test/bake/dev/import-meta-inline.test.ts
test/integration/sharp/sharp.test.ts
test/cli/test/bun-test.test.ts
test/cli/install/bun-install-security-provider.test.ts
test/js/node/test/parallel/test-tls-fast-writing.js
test/js/bun/sqlite/sqlite.test.js
test/js/workerd/html-rewriter.test.js
test/regression/issue/12250.test.ts
test/js/bun/test/parallel/test-http-10177-response.write-with-non-ascii-latin1-should-not-cause-duplicated-character-or-segfault.ts
test/cli/install/minimum-release-age.test.ts


# crash for reasons not related to LSAN
test/js/node/test/parallel/test-fs-watch-recursive-watch-file.js
test/js/node/test/parallel/test-dgram-send-address-types.js
test/js/node/test/parallel/test-fs-watch.js
test/js/node/test/parallel/test-dgram-unref.js
test/js/node/test/parallel/test-fs-promises-watch.js
test/bake/dev/ecosystem.test.ts
test/bake/dev/html.test.ts
test/bake/dev/plugins.test.ts
test/bake/dev/stress.test.ts
test/bake/dev/vfile.test.ts
test/js/bun/http/serve.test.ts
test/js/bun/resolve/import-meta.test.js
test/js/node/worker_threads/worker_threads.test.ts
test/js/third_party/@duckdb/node-api/duckdb.test.ts
test/js/third_party/body-parser/express-bun-build-compile.test.ts
test/js/third_party/duckdb/duckdb-basic-usage.test.ts


# ASSERTION FAILED: m_normalWorld->hasOneRef()
test/js/node/test/parallel/test-unhandled-exception-with-worker-inuse.js
test/js/node/test/parallel/test-process-beforeexit-throw-exit.js
test/js/node/test/parallel/test-async-hooks-worker-asyncfn-terminate-1.js
test/js/node/test/parallel/test-crypto-prime.js
test/js/node/test/parallel/test-async-hooks-worker-asyncfn-terminate-4.js
test/js/node/test/parallel/test-async-hooks-worker-asyncfn-terminate-2.js
test/js/node/test/parallel/test-async-hooks-worker-asyncfn-terminate-3.js
test/js/third_party/@fastify/websocket/fastity-test-websocket.test.js
test/js/third_party/esbuild/esbuild-child_process.test.ts
test/js/third_party/pino/pino.test.js
test/js/third_party/socket.io/socket.io-close.test.ts
test/js/web/websocket/websocket-permessage-deflate-edge-cases.test.ts
test/js/web/websocket/websocket-permessage-deflate-simple.test.ts
test/js/web/websocket/websocket-upgrade.test.ts
test/js/web/workers/message-channel.test.ts
test/js/web/workers/worker_blob.test.ts
test/regression/issue/012040.test.ts
test/js/web/websocket/websocket-blob.test.ts
test/regression/issue/14338.test.ts
test/js/bun/util/heap-snapshot.test.ts
test/regression/issue/02499/02499.test.ts
test/js/node/test/parallel/test-http-server-stale-close.js
test/js/third_party/comlink/comlink.test.ts
test/regression/issue/22635/22635.test.ts


# Bun::JSNodeHTTPServerSocket::clearSocketData
test/js/node/test/parallel/test-http-server-keep-alive-max-requests-null.js
test/js/node/test/parallel/test-http-keep-alive-pipeline-max-requests.js
test/js/node/test/parallel/test-https-connecting-to-http.js
test/js/node/test/parallel/test-http-header-overflow.js
test/js/node/test/parallel/test-http-request-smuggling-content-length.js
test/js/node/test/parallel/test-http-server-keep-alive-defaults.js
test/js/node/test/parallel/test-http-socket-error-listeners.js
test/js/node/test/parallel/test-http-server-destroy-socket-on-client-error.js
test/js/node/test/parallel/test-http-dummy-characters-smuggling.js
test/js/node/test/parallel/test-http-missing-header-separator-lf.js
test/js/node/test/parallel/test-http-invalid-te.js
test/js/node/test/parallel/test-http-missing-header-separator-cr.js
test/js/node/test/parallel/test-http-server-reject-chunked-with-content-length.js
test/js/node/test/parallel/test-http-chunked-smuggling.js
test/js/node/test/parallel/test-http-double-content-length.js
test/js/node/test/parallel/test-http-blank-header.js
test/js/node/test/parallel/test-http-server-keepalive-req-gc.js

# bun.assert(!this.hasPendingActivity() or jsc.VirtualMachine.get().isShuttingDown());
# @call(bun.callmod_inline, Subprocess.finalize, .{thisValue});
test/js/node/test/parallel/test-set-http-max-http-headers.js
test/js/node/test/parallel/test-child-process-windows-hide.js
test/cli/inspect/BunFrontendDevServer.test.ts
test/cli/inspect/HTTPServerAgent.test.ts
test/cli/inspect/inspect.test.ts
test/cli/install/bun-publish.test.ts
test/cli/install/catalogs.test.ts
test/cli/run/self-reference.test.ts
test/cli/watch/watch.test.ts
test/js/bun/console/console-iterator.test.ts
test/js/bun/http/async-iterator-stream.test.ts
test/js/bun/http/bun-serve-body-json-async.test.ts
test/js/bun/http/bun-serve-html.test.ts
test/js/bun/shell/env.positionals.test.ts
test/js/bun/spawn/bun-ipc-inherit.test.ts
test/js/bun/spawn/spawn-stdin-readable-stream-integration.test.ts
test/js/bun/spawn/spawn.ipc.node-bun.test.ts
test/js/bun/spawn/spawn.ipc.test.ts
test/js/bun/udp/dgram.test.ts
test/js/bun/websocket/websocket-server.test.ts
test/js/first_party/ws/ws.test.ts
test/js/node/child_process/child_process-node.test.js
test/js/node/child_process/child_process.test.ts
test/js/node/crypto/crypto.test.ts
test/js/node/dgram/node-dgram.test.js
test/js/node/process/process-args.test.js
test/js/node/tls/renegotiation.test.ts
test/js/third_party/astro/astro-post.test.js
test/js/third_party/grpc-js/test-tonic.test.ts
test/js/web/fetch/fetch.test.ts
test/js/web/timers/setImmediate.test.js
test/js/web/websocket/autobahn.test.ts
test/js/web/websocket/websocket-client.test.ts
test/regression/issue/04298/04298.test.ts
test/regression/issue/08095.test.ts
test/regression/issue/20144/20144.test.ts
test/regression/issue/update-interactive-formatting.test.ts
test/regression/issue/246-child_process_object_assign_compatibility.test.ts
test/cli/install/bun-pm-scan.test.ts
test/bake/dev/incremental-graph-edge-deletion.test.ts
test/cli/update_interactive_snapshots.test.ts
test/js/web/websocket/websocket-custom-headers.test.ts
test/js/third_party/body-parser/express-memory-leak.test.ts
test/js/bun/http/serve-body-leak.test.ts
test/cli/install/migration/yarn-lock-migration.test.ts
test/regression/issue/test_env_loader_threading.test.ts

# Zig::SourceProvider::~SourceProvider()
test/bundler/bundler_bun.test.ts
test/bundler/bundler_cjs2esm.test.ts
test/bundler/bundler_edgecase.test.ts
test/bundler/bundler_jsx.test.ts
test/bundler/bundler_loader.test.ts
test/bundler/bundler_minify.test.ts
test/bundler/esbuild/dce.test.ts
test/bundler/esbuild/default.test.ts
test/bundler/esbuild/extra.test.ts
test/bundler/esbuild/loader.test.ts
test/bundler/esbuild/splitting.test.ts
test/bundler/html-import-manifest.test.ts
test/js/node/process/process-on.test.ts
test/js/node/v8/capture-stack-trace.test.js
vendor/elysia/test/aot/analysis.test.ts
vendor/elysia/test/aot/generation.test.ts
vendor/elysia/test/aot/has-transform.test.ts
vendor/elysia/test/aot/has-type.test.ts
vendor/elysia/test/aot/response.test.ts
vendor/elysia/test/cookie/response.test.ts
vendor/elysia/test/core/as.test.ts
vendor/elysia/test/core/config.test.ts
vendor/elysia/test/core/dynamic.test.ts
vendor/elysia/test/core/elysia.test.ts
vendor/elysia/test/core/handle-error.test.ts
vendor/elysia/test/core/modules.test.ts
vendor/elysia/test/core/mount.test.ts
vendor/elysia/test/core/native-static.test.ts
vendor/elysia/test/core/normalize.test.ts
vendor/elysia/test/core/redirect.test.ts
vendor/elysia/test/core/response.test.ts
vendor/elysia/test/core/scoped.test.ts
vendor/elysia/test/core/stop.test.ts
vendor/elysia/test/extends/decorators.test.ts
vendor/elysia/test/extends/error.test.ts
vendor/elysia/test/extends/models.test.ts
vendor/elysia/test/extends/store.test.ts
vendor/elysia/test/hoc/index.test.ts
vendor/elysia/test/lifecycle/after-handle.test.ts
vendor/elysia/test/lifecycle/before-handle.test.ts
vendor/elysia/test/lifecycle/derive.test.ts
vendor/elysia/test/lifecycle/error.test.ts
vendor/elysia/test/lifecycle/hook-types.test.ts
vendor/elysia/test/lifecycle/map-derive.test.ts
vendor/elysia/test/lifecycle/map-resolve.test.ts
vendor/elysia/test/lifecycle/map-response.test.ts
vendor/elysia/test/lifecycle/parser.test.ts
vendor/elysia/test/lifecycle/request.test.ts
vendor/elysia/test/lifecycle/resolve.test.ts
vendor/elysia/test/lifecycle/response.test.ts
vendor/elysia/test/lifecycle/transform.test.ts
vendor/elysia/test/macro/macro.test.ts
vendor/elysia/test/path/group.test.ts
vendor/elysia/test/path/guard.test.ts
vendor/elysia/test/path/path.test.ts
vendor/elysia/test/path/plugin.test.ts
vendor/elysia/test/plugins/affix.test.ts
vendor/elysia/test/plugins/checksum.test.ts
vendor/elysia/test/plugins/error-propagation.test.ts
vendor/elysia/test/production/index.test.ts
vendor/elysia/test/response/custom-response.test.ts
vendor/elysia/test/response/headers.test.ts
vendor/elysia/test/response/redirect.test.ts
vendor/elysia/test/response/static.test.ts
vendor/elysia/test/response/stream.test.ts
vendor/elysia/test/sucrose/query.test.ts
vendor/elysia/test/sucrose/sucrose.test.ts
vendor/elysia/test/tracer/aot.test.ts
vendor/elysia/test/tracer/detail.test.ts
vendor/elysia/test/tracer/timing.test.ts
vendor/elysia/test/tracer/trace.test.ts
vendor/elysia/test/type-system/array-string.test.ts
vendor/elysia/test/type-system/boolean-string.test.ts
vendor/elysia/test/type-system/coercion-number.test.ts
vendor/elysia/test/type-system/date.test.ts
vendor/elysia/test/type-system/object-string.test.ts
vendor/elysia/test/type-system/string-format.test.ts
vendor/elysia/test/type-system/union-enum.test.ts
vendor/elysia/test/units/deduplicate-checksum.test.ts
vendor/elysia/test/units/map-compact-response.test.ts
vendor/elysia/test/units/map-early-response.test.ts
vendor/elysia/test/units/map-response.test.ts
vendor/elysia/test/units/merge-deep.test.ts
vendor/elysia/test/units/replace-schema-type.test.ts
vendor/elysia/test/validator/body.test.ts
vendor/elysia/test/validator/header.test.ts
vendor/elysia/test/validator/params.test.ts
vendor/elysia/test/validator/query.test.ts
vendor/elysia/test/validator/response.test.ts
vendor/elysia/test/validator/validator.test.ts
vendor/elysia/test/ws/destructuring.test.ts
vendor/elysia/test/ws/message.test.ts

# JSC::HandleSet::~HandleSet
# bun.js.rare_data.deinit
test/js/bun/resolve/resolve.test.ts
test/js/bun/s3/s3-storage-class.test.ts
test/js/bun/s3/s3.test.ts
test/js/bun/util/BunObject.test.ts
test/js/bun/util/fuzzy-wuzzy.test.ts
test/js/bun/util/inspect.test.js
test/js/node/util/node-inspect-tests/parallel/util-inspect.test.js
test/js/node/vm/vm.test.ts

# VM has terminated
test/js/node/test/parallel/test-net-during-close.js

# JSC::BuiltinNames::~BuiltinNames
test/js/bun/shell/shell-hang.test.ts
test/js/bun/util/reportError.test.ts
test/js/node/fs/abort-signal-leak-read-write-file.test.ts
test/js/node/process/process.test.js
test/js/web/websocket/websocket.test.js
test/js/web/workers/worker.test.ts
test/regression/issue/11664.test.ts

# ASSERTION FAILED: m_cellState == CellState::DefinitelyWhite
test/js/node/tls/node-tls-upgrade.test.ts
test/js/third_party/duckdb/duckdb-basic-usage.test.ts

# Bun::NapiExternal::~NapiExternal
test/v8/v8.test.ts
test/napi/node-napi-tests/test/js-native-api/test_general/do.test.ts
test/napi/node-napi-tests/test/js-native-api/6_object_wrap/do.test.ts

test/bake/dev/production.test.ts
test/js/third_party/pg-gateway/pglite.test.ts

test/js/web/websocket/websocket-subprotocol-strict.test.ts
test/js/node/net/node-net-server.test.ts
test/js/third_party/grpc-js/test-channel-credentials.test.ts
test/js/bun/http/bun-connect-x509.test.ts
test/js/third_party/rollup-v4/rollup-v4.test.ts
test/js/web/abort/abort.test.ts
test/js/third_party/resvg/bbox.test.js
test/regression/issue/10139.test.ts
test/js/bun/udp/udp_socket.test.ts
test/cli/init/init.test.ts

# There are some leaks related to the dev server closing on process exit, the fix is to
# tick the event loop on globalExit but this breaks like 50 tests. Since the
# leak is when process exits it should be fine for now but it should be fixed at
# some point.
test/bake/dev/react-response.test.ts
test/bake/dev/react-cookies.test.ts
test/bake/dev/server-sourcemap.test.ts

# Watcher Thread
test/bake/dev-and-prod.test.ts
test/bake/dev/bundle.test.ts
test/bake/dev/css.test.ts
test/bake/dev/esm.test.ts
test/bake/dev/hot.test.ts
test/bake/dev/react-spa.test.ts
test/bake/dev/sourcemap.test.ts
test/bake/dev/ssg-pages-router.test.ts
test/bake/dev/deinitialization.test.ts

# Need to terminate HTTP thread.
test/js/bun/test/parallel/test-http-should-not-accept-untrusted-certificates.ts

# Need to run the event loop once more to ensure sockets close
test/js/node/test/parallel/test-https-localaddress-bind-error.js
test/js/node/test/parallel/test-crypto-op-during-process-exit.js